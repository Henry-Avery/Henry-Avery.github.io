<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="SHU模式识别, SHU19级小天爷( •̀ ω •́ )y">
    <meta name="baidu-site-verification" content="fmlEuI34ir">
    <meta name="google-site-verification" content="yCy2azpds5XSuGZvis6OuA-XIGF5GuGpYRAaGfD6o48">
    <meta name="360-site-verification" content="b7c11a830ef90fd1464ad6206bb7b6e7">
    <meta name="description" content="SHU模式识别课程笔记ycfang@staff.shu.edu.cn
东区917
《模式识别与机器学习》
前言
概率论
是时候开始重学概率论了。
b站宋浩概率论

《概率论》学习笔记 - 是傅里叶啦的文章 - 知乎 https://zhua">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>SHU模式识别 | 小天爷的博客</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?46e79e71af0709a5b9106bf20cecc493";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

    
        <script>
            (function(){
                var bp = document.createElement('script');
                var curProtocol = window.location.protocol.split(':')[0];
                if (curProtocol === 'https') {
                    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
                }
                else {
                    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                }
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(bp, s);
            })();
        </script>
    

    <script>
        (function(){
        var src = "https://jspassport.ssl.qhimg.com/11.0.1.js?d182b3f28525f2db83acfaaf6e696dba";
        document.write('<script src="' + src + '" id="sozz"><\/script>');
        })();
    </script>

<script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
    </script>
    
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body>

    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">小天爷的博客</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>友情链接</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/contact" class="waves-effect waves-light">
            
            <i class="fa fa-comments"></i>
            
            <span>留言板</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">小天爷的博客</div>
        <div class="logo-desc">
            
            商才士魂
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                友情链接
            </a>
        </li>
        
        <li>
            <a href="/contact" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-comments"></i>
                
                留言板
            </a>
        </li>
        
        
    </ul>
</div>

        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/24.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        SHU模式识别
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                        <a href="/tags/SHU/" target="_blank">
                            <span class="chip bg-color">SHU</span>
                        </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                        <a href="/categories/学习笔记/" class="post-category" target="_blank">
                            学习笔记
                        </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-12-31
                </div>

                <div class="post-author info-break-policy">
                    <i class="fa fa-user-o fa-fw"></i>作者:&nbsp;&nbsp;
                    
                    Henry-Avery
                    
                </div>

                
                
                <div class="info-break-policy">
                    <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                    12.5k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    52 分
                </div>
                
                

                
                <div id="busuanzi_container_page_pv" class="info-break-policy">
                    <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                    <span id="busuanzi_value_page_pv"></span>
                </div>
                
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="SHU模式识别课程笔记"><a href="#SHU模式识别课程笔记" class="headerlink" title="SHU模式识别课程笔记"></a>SHU模式识别课程笔记</h1><p><a href="mailto:ycfang@staff.shu.edu.cn" target="_blank" rel="noopener">ycfang@staff.shu.edu.cn</a></p>
<p>东区917</p>
<p>《模式识别与机器学习》</p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112190933482.jpeg" alt="img"></p>
<h3 id="概率论"><a href="#概率论" class="headerlink" title="概率论"></a>概率论</h3><blockquote>
<p>是时候开始重学概率论了。</p>
<p><a href="https://www.bilibili.com/video/BV1ot411y7mU?spm_id_from=333.999.0.0" target="_blank" rel="noopener">b站宋浩概率论</a></p>
</blockquote>
<p>《概率论》学习笔记 - 是傅里叶啦的文章 - 知乎 <a href="https://zhuanlan.zhihu.com/p/418319247" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/418319247</a></p>
<p><strong>随机变量</strong></p>
<p>是值为一个随机事件的结果的变量。</p>
<p>量化随机事件的函数，将随机事件每一个出现的结果赋予了一个数字。</p>
<p><strong>概率分布</strong></p>
<p><strong>概率分布</strong>是随机变量所有可能结果及其相应概率的列表。</p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112012018655.jpeg" alt="离散概率分布"></p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112012019074.jpeg" alt="连续概率分布"></p>
<p>卡方分布、学生t分布和F分布</p>
<p><strong>泰勒公式</strong></p>
<p>简单来讲就是用一个多项式函数去逼近一个给定的函数(即尽量使多项式函数图像拟合给定的函数图像)，注意，逼近的时候一定是从函数图像上的某个点展开。如果一个非常复杂函数，想求其某点的值，直接求无法实现，这时候可以使用泰勒公式去近似的求该值，这是泰勒公式的应用之一。泰勒公式在机器学习中主要应用于梯度迭代。<br>————————————————<br>版权声明：本文为CSDN博主「豆沙糕」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/qq_38646027/article/details/88014692" target="_blank" rel="noopener">https://blog.csdn.net/qq_38646027/article/details/88014692</a></p>
<hr>
<h2 id="Chap1概论"><a href="#Chap1概论" class="headerlink" title="Chap1概论"></a>Chap1概论</h2><h2 id="Chap2-贝叶斯决策理论"><a href="#Chap2-贝叶斯决策理论" class="headerlink" title="Chap2 贝叶斯决策理论"></a>Chap2 贝叶斯决策理论</h2><h3 id="2-1-贝叶斯决策的基本概念"><a href="#2-1-贝叶斯决策的基本概念" class="headerlink" title="2.1 贝叶斯决策的基本概念"></a><strong>2.1</strong> <strong>贝叶斯决策的基本概念</strong></h3><p>先验概率</p>
<p>类条件概率密度函数</p>
<p>后验概率</p>
<p>贝叶斯公式</p>
<h3 id="2-2-几种常用的决策规则"><a href="#2-2-几种常用的决策规则" class="headerlink" title="2.2 几种常用的决策规则"></a><strong>2.2</strong> <strong>几种常用的决策规则</strong></h3><p>最小错误率准则</p>
<hr>
<p>最小风险准则</p>
<hr>
<p>限定错误率的两类决策</p>
<blockquote>
<p>错误率的两类，不是两类决策</p>
</blockquote>
<p>Neyman-Pearson决策</p>
<hr>
<p>最大最小决策（Maximum and minimum decision making method）</p>
<blockquote>
<p>先验概率变化，如何使最大可能的风险最小，也就是在最差的条件下争取最好的结果。</p>
<p><a href="https://blog.csdn.net/lyxleft/article/details/79547353" target="_blank" rel="noopener">贝叶斯决策理论（三）：最小最大决策、序贯分类</a></p>
</blockquote>
<hr>
<p>最小最大决策准则？</p>
<h3 id="2-3-正态分布时的统计决策"><a href="#2-3-正态分布时的统计决策" class="headerlink" title="2.3 正态分布时的统计决策"></a><strong>2.3</strong> <strong>正态分布时的统计决策</strong></h3><p>单变量正态分布</p>
<p>多变量正态分布</p>
<hr>
<p><strong>正态分布模型下的最小错误率贝叶斯决策</strong></p>
<p>特例123</p>
<hr>
<h3 id="2-4-概率密度函数估计"><a href="#2-4-概率密度函数估计" class="headerlink" title="2.4 概率密度函数估计"></a><strong>2.4</strong> <strong>概率密度函数估计</strong></h3><p><strong>实际问题bayes分类器求解</strong></p>
<p>输入类数，特征数，待分样本数</p>
<p>输入训练样本数和训练样本集</p>
<p><strong>计算先验概率</strong></p>
<blockquote>
<p>用训练数据中各类出现的频率来估计，或者直接依靠经验</p>
</blockquote>
<p><strong>计算类条件概率密度</strong></p>
<blockquote>
<p>参数估计（最大似然估计，Bayes估计）</p>
<p>非参数估计</p>
</blockquote>
<p>计算各类的后验概率</p>
<p>若按最小错误率原则分类，则根据后验概率判定</p>
<p>若按最小风险原则分类，则计算各样本属于各类时的风险并判定</p>
<hr>
<p>极大似然估计</p>
<p>贝叶斯估计与贝叶斯学习</p>
<p>正态分布Bayes决策应用</p>
<hr>
<p><strong>非参数估计</strong></p>
<blockquote>
<p>实验可以做假设检验</p>
</blockquote>
<p>非参数估计：密度函数的形式未知，也不作假设，利用训练数据直接对概率密度进行估计（模型无关方法）</p>
<p><strong>基本思想</strong></p>
<p>估计的目的：从样本集<em>K=</em> {<strong>x*</strong>1<em>, <strong>x</strong></em>2<em>,…, <strong>x</strong></em>N<em>}估计样本空间中任何一点的概率密度p(<em>*x</em></em>)</p>
<p>基本方法：用某种核函数表示某一样本对待估计的密度函数的贡献，所有样本所作贡献的线性组合视作对某点概率密度<em>p</em>(<strong>x</strong>)的估计</p>
<p><strong>Parzen窗法（基本思想）</strong></p>
<p>归一化条件</p>
<p>常用核函数：均匀核，高斯核，指数窗</p>
<p>窗宽，太大：平均化，分辨率低。太小，统计变动大。</p>
<blockquote>
<p>很古老但一直在被用，虽然不再江湖，但江湖上却一直流传着他的名字</p>
</blockquote>
<blockquote>
<p>某一个分布决定了哪一个样本最多，怎么去取样？</p>
</blockquote>
<p>性能：应用普遍，样本足够多才有较好估计</p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112151940584.png" alt="image-20211215194055472"></p>
<h3 id="2-5-分类器错误率问题"><a href="#2-5-分类器错误率问题" class="headerlink" title="2.5 分类器错误率问题"></a><strong>2.5</strong> <strong>分类器错误率问题</strong></h3><p>对于已设计好的分类器，利用样本来估计错误率。</p>
<p>对于未设计好的分类器，需将样本分成训练集和测试集。</p>
<hr>
<blockquote>
<p>不知道为什么突然开始讲分布了</p>
</blockquote>
<p>学生分布多峰不受影响，与高斯分布区别</p>
<p>直接暴力上了个直方图</p>
<blockquote>
<p>来自PRML，不相信机器学习，所有模型都用图表示，跟句法有什么关系？应用上没有什么成就。</p>
<p>概率统计上有什么可以参考这本书。</p>
</blockquote>
<hr>
<h2 id="Chap3-线性分类器"><a href="#Chap3-线性分类器" class="headerlink" title="Chap3 线性分类器"></a>Chap3 线性分类器</h2><h3 id="3-0-线性判别函数基本概念"><a href="#3-0-线性判别函数基本概念" class="headerlink" title="3.0 线性判别函数基本概念"></a>3.0 线性判别函数基本概念</h3><p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112221916228.png" alt="image-20211222191610062"></p>
<blockquote>
<p>实际问题中间环节庞杂，获取分布很难，DL直接确定判别函数</p>
</blockquote>
<hr>
<p><strong>判别函数种类</strong></p>
<p>线性判别函数：</p>
<ul>
<li>线性判别函数</li>
<li>广义线性判别函数</li>
<li>分段线性判别函数</li>
</ul>
<p>非线性判别函数</p>
<hr>
<p><strong>判别函数一般定义</strong></p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112221919037.png" alt="image-20211222191930928"></p>
<p>两类二维</p>
<p>两类多维</p>
<p>多类线性判别函数，两种情况，单个面和$\frac{C(C-1)}{2}$个线性判别函数，每两类一个。</p>
<p>决策树也可以用。。实现</p>
<hr>
<h3 id="3-1-Fisher线性判别准则"><a href="#3-1-Fisher线性判别准则" class="headerlink" title="3.1 Fisher线性判别准则"></a>3.1 Fisher线性判别准则</h3><blockquote>
<p>画图，分界面，贝叶斯决策比较一下？</p>
</blockquote>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112221927706.png" alt="image-20211222192712561"></p>
<hr>
<blockquote>
<p>让我们从二类开始</p>
</blockquote>
<p>Fisher准则函数（<strong>问题描述</strong>）</p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112221929241.png" alt="image-20211222192934108"><br>$$<br>m_i=\frac{1}{n_1}\sum_{y_k \in Y_i}y_k=\frac{1}{n_1}\sum_{x_k \in X_i}w^Tx_k=w^TM_i<br>$$</p>
<hr>
<p>Fisher准则函数(<strong>离散度</strong>)</p>
<p><strong>投影样本类间</strong>离散度<br>$$<br>|m_1-m_2|^2=|w^T(M_1-M_2)|^2 \<br>=w^T(M_1-M_2)(M_1-M_2)^Tw<br>$$</p>
<p>$S_b=(M_1-M_2)(M_1-M_2)^T$就是类间散度矩阵</p>
<p><strong>投影样本类内</strong>离散度<br>$$<br>\begin{align}<br>S_i^2 &amp;=\sum_{y_k \in Y_i}(y_k-m_i)^2    \<br>&amp; =\sum_{x_k \in X_i}(w^Tx_k-w^TM_i)^2\<br>&amp; =w^T\tilde{S_i}w\\</p>
<p>\end{align}<br>$$<br>$\tilde{S_i}=\sum_{x_k \in X_i}(x_k-M_i)(x_k-M_i)^T$</p>
<blockquote>
<p>这个类别的协方差估计</p>
</blockquote>
<hr>
<p>Fisher准则函数(<strong>定义</strong>)<br>$$<br>J_F=\frac{|m_1-m_2|^2}{S_1^2+S_2^2}<br>$$<br>$|m_1-m_2|^2=|w^T(M_1-M_2)|^2=w^T(M_1-M_2)(M_1-M_2)^Tw$</p>
<p>$S_1^2+S_2^2=w^T\tilde{S_1}w+w^T\tilde{S_2}w=w^T(\tilde{S_1}+\tilde{S_2})w$</p>
<p>$S_b=(M_1-M_2)(M_1-M_2)^T$</p>
<p>$\tilde{S_w}=\tilde{S_1}+\tilde{S_2}$<br>$$<br>\begin{align}<br>&amp;J_F=\frac{w^T \tilde{S_b} w^T}{w^T\tilde{S_w}w}\<br>&amp;L(w,\lambda)=w^T\tilde{S_b}w-\lambda(w^T\tilde{S_w}w-c)\<br>&amp;\frac{\partial L(w,\lambda)}{\partial w}=2(\tilde{S_b}w-\lambda \tilde{S_w}w)=0\<br>\end{align}\<br>$$<br>$\Rightarrow \tilde{S_b}w^<em>=\lambda \tilde{S_w}w^</em>$</p>
<blockquote>
<p>拉格朗日闭着眼睛写，说不定哪天就考到了。</p>
</blockquote>
<p>$$<br>\begin{align}<br>\Rightarrow \lambda w^<em>&amp;=\tilde{S_w}^{-1}\tilde{S_b}w^</em>\<br>&amp;=\tilde{S_w}^{-1}(M_1-M_2)(M_1-M_2)^T w^*\<br>&amp;= \tilde{S_w}^{-1}(M_1-M_2)\gamma \\</p>
<p>\end{align}\<br>$$</p>
<p>$\Rightarrow w^<em>=\frac{\gamma}{\lambda} \tilde{S_w}^{-1}(M_1-M_2)\Leftrightarrow w^</em>=\tilde{S_w}^{-1}(M_1-M_2)$</p>
<blockquote>
<p>最后一步常数怎么没了？w的大小对结果没有影响，只要求出w的方向即可。就是投影算子w可以忽略比例，也可以理解为找到决策方程的系数参数，或者说决策面的参数。</p>
</blockquote>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112222307995.png" alt="image-20211222230732929"></p>
<hr>
<p>close-form</p>
<blockquote>
<p>数学里面很厉害的结论,很漂亮</p>
</blockquote>
<p>假设分母是小常数c，作为约束条件，让分子大</p>
<p>类内散度作为正则项</p>
<p>拉格朗日</p>
<p>求导，就是矩阵代数里的矩阵微分</p>
<p>按理两个变量求导，fisher牛，只对w求导就可以了。</p>
<p>类间离散度越小越好，类内离散度越大越好</p>
<hr>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112222003837.png" alt="image-20211222200302619"></p>
<blockquote>
<p>后面就是考虑了天然的先验分布，考虑有偏无偏的区别</p>
</blockquote>
<p>Fisher准则函数(<strong>步骤</strong>)</p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112222006652.png" alt="image-20211222200630493"></p>
<h3 id="3-2-感知准则函数"><a href="#3-2-感知准则函数" class="headerlink" title="3.2 感知准则函数"></a>3.2 感知准则函数</h3><blockquote>
<p>Frank Rosenblatt出生在纽约，父亲是医生，其1956年在Cornell大学拿到博士学位后，留校任教，研究方向为心理学和认知心理学。1957年，Frank提出了Perceptron的理论。1960年，在计算机运算能力还不强的时候，其使用基于硬件结构搭建了一个神经网络，大概长下面这样（跪）。</p>
</blockquote>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112291959080.png" alt="cool"></p>
<blockquote>
<p>但是和所有先驱一样，Frank开创性的工作并没有在当时得到认可。当时两位科学家 Marvin Minksy 和 Seymour Papert（这两位之后都成了AI界泰斗级的人物）对Frank的工作表示质疑，认为他只不过想博取世人眼球，并且还特地写了一本书来批判Perceptron，书名就叫《Perceptron》。也就是这本书，导致Perceptron沉寂了将近20年，直到80年代另一位dalao — Hinton发明BP算法，让其成为当今AI最热门的领域。</p>
</blockquote>
<ul>
<li><p>随意确定的判别函数初始权值</p>
</li>
<li><p>通过训练样本逐步修正权值</p>
</li>
</ul>
<p>规范化，增广</p>
<p>梯度下降法</p>
<p>感知器准则函数梯度法示例12</p>
<h3 id="3-3-最小平方误差准则"><a href="#3-3-最小平方误差准则" class="headerlink" title="3.3 最小平方误差准则"></a>3.3 最小平方误差准则</h3><p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112292016707.png" alt="image-20211229201604557"></p>
<blockquote>
<p>克拉姆法则求解，不定有多解，随便设了个b</p>
</blockquote>
<p>矛盾方程组，方程数大于未知数，无精确解</p>
<blockquote>
<p>MSE准则函数，其实矩阵代数学过</p>
</blockquote>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112292018990.png" alt></p>
<p>求b</p>
<p>权值迭代公式</p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112292021230.png" alt="image-20211229202144084"></p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112292023629.png" alt="牛"></p>
<blockquote>
<p>MSE解等价于Fisher解，迭代解误差足够小或者次数足够结束。</p>
</blockquote>
<hr>
<h2 id="Chap4-knn近邻法"><a href="#Chap4-knn近邻法" class="headerlink" title="Chap4 knn近邻法"></a>Chap4 knn近邻法</h2><h3 id="4-1-最近邻法和近邻法则"><a href="#4-1-最近邻法和近邻法则" class="headerlink" title="4.1 最近邻法和近邻法则"></a>4.1 最近邻法和近邻法则</h3><blockquote>
<p>最重要的非参数方法就是近邻法</p>
</blockquote>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112292030212.png" alt></p>
<h3 id="4-2-k近邻法-模糊k近邻分类器"><a href="#4-2-k近邻法-模糊k近邻分类器" class="headerlink" title="4.2 k近邻法, 模糊k近邻分类器"></a>4.2 k近邻法, 模糊k近邻分类器</h3><h3 id="4-3-改进的近邻法"><a href="#4-3-改进的近邻法" class="headerlink" title="4.3 改进的近邻法"></a>4.3 改进的近邻法</h3><h1 id="研讨"><a href="#研讨" class="headerlink" title="研讨"></a>研讨</h1><h2 id="评估指标"><a href="#评估指标" class="headerlink" title="评估指标"></a>评估指标</h2><blockquote>
<p>对不起我补笔记忘了记了。从中间开始好了。</p>
</blockquote>
<p>自举法，基本思想是有放回的抽样，</p>
<blockquote>
<p>.632估计，加权</p>
</blockquote>
<hr>
<p>分类器性能度量指标及非均衡问题的解决</p>
<p>混淆矩阵</p>
<p>FRR</p>
<p>TRR</p>
<p>ERR等错误率</p>
<p>ROC和AUC</p>
<hr>
<p>非均衡问题</p>
<p>随机过采样，随机前采样</p>
<p>基于代价敏感的算法</p>
<hr>
<h2 id="线性回归"><a href="#线性回归" class="headerlink" title="线性回归"></a>线性回归</h2><blockquote>
<p>机器学习实验做的图</p>
</blockquote>
<p>局部加权线性回归</p>
<p>多重共线性，模型中变量高度相关</p>
<p><a href="https://blog.csdn.net/foneone/article/details/101945415" target="_blank" rel="noopener">逐步回归的三种主要</a>：前向逐步回归，后向逐步回归，逐步回归</p>
<hr>
<p>岭回归：解决这类问题可以使用岭回归和LASSO回归，主要针对自变量之间存在多重共线性或者自变量个数多于样本量的情况。</p>
<p><a href="https://blog.csdn.net/weixin_43374551/article/details/83688913" target="_blank" rel="noopener">机器学习十大经典算法之岭回归和LASSO回归（学习笔记整理）</a></p>
<p>岭回归模型在目标函数上加了一个L2范数的惩罚项</p>
<hr>
<h2 id="逻辑回归"><a href="#逻辑回归" class="headerlink" title="逻辑回归"></a>逻辑回归</h2><p>董镇源</p>
<p>机器学习任务：分类回归聚类</p>
<p>sigmoid函数，二分类</p>
<p>推导一下，公式一堆，其实就是最大似然估计和</p>
<p>梯度上升与梯度下降其实是一回事</p>
<p>softmax函数，多分类</p>
<p>transformer</p>
<hr>
<h2 id="多人姿态检测"><a href="#多人姿态检测" class="headerlink" title="多人姿态检测"></a>多人姿态检测</h2><p>YOLO</p>
<p>Pose</p>
<hr>
<h2 id="YuNet"><a href="#YuNet" class="headerlink" title="YuNet"></a>YuNet</h2><p>CNN</p>
<p>DW和PW</p>
<p>EIOU</p>
<p>解决难易样本不平衡。</p>
<hr>
<p>山世光</p>
<p>于仕琪（NTU）</p>
<h1 id="上机实验"><a href="#上机实验" class="headerlink" title="上机实验"></a>上机实验</h1><h2 id="实验一-可视化分析-opencv"><a href="#实验一-可视化分析-opencv" class="headerlink" title="实验一 可视化分析+opencv"></a>实验一 可视化分析+opencv</h2><h3 id="数据分析基础"><a href="#数据分析基础" class="headerlink" title="数据分析基础"></a>数据分析基础</h3><p>处理收集到的身高体重等数据，并画出直方图可视化</p>
<blockquote>
<p>pycharm的快捷键CTRL+Y被redo占用了，那我就把删除整行设置成ALT+Y好了</p>
</blockquote>
<p><strong>资料</strong></p>
<p><strong>matplotlib</strong></p>
<p><a href="https://blog.csdn.net/qq_42600434/article/details/81626749" target="_blank" rel="noopener">python中plt.hist参数详解</a></p>
<blockquote>
<pre><code> matplotlib.pyplot.hist(  
 x, bins=10, range=None, normed=False,   
 weights=None, cumulative=False, bottom=None,   
 histtype=u&#39;bar&#39;, align=u&#39;mid&#39;, orientation=u&#39;vertical&#39;,   
 rwidth=None, log=False, color=None, label=None, stacked=False,   
 hold=None, **kwargs)  </code></pre></blockquote>
<p><a href="https://gene-liu.blog.csdn.net/article/details/103652878?spm=1001.2101.3001.6650.4&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-4.no_search_link&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-4.no_search_link" target="_blank" rel="noopener">CSDN一次性掌握所有 Python 画图基础操作</a></p>
<p><a href="https://blog.csdn.net/wangxingfan316/article/details/80033557" target="_blank" rel="noopener">CSDNpandas库scatter_matrix绘图可视化参数详解</a></p>
<pre class="line-numbers language-python"><code class="language-python">scatter_matrix<span class="token punctuation">(</span>frame<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> c<span class="token punctuation">,</span>figsize<span class="token operator">=</span>None<span class="token punctuation">,</span> ax<span class="token operator">=</span>None<span class="token punctuation">,</span> diagonal<span class="token operator">=</span><span class="token string">'hist'</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'.'</span><span class="token punctuation">,</span> density_kwds<span class="token operator">=</span>None<span class="token punctuation">,</span>hist_kwds<span class="token operator">=</span>None<span class="token punctuation">,</span> range_padding<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwds<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<p>1。frame，pandas dataframe对象<br>2。alpha， 图像透明度，一般取(0,1]<br>3。figsize，以英寸为单位的图像大小，一般以元组 (width, height) 形式设置<br>4。ax，可选一般为none<br>5。diagonal，必须且只能在{‘hist’, ‘kde’}中选择1个，’hist’表示直方图(Histogram plot),’kde’表示核密度估计(Kernel Density Estimation)；该参数是scatter_matrix函数的关键参数<br>6。marker。Matplotlib可用的标记类型，如’.’，’,’，’o’等<br>7。density_kwds。(other plotting keyword arguments，可选)，与kde相关的字典参数<br>8。hist_kwds。与hist相关的字典参数<br>9。range_padding。(float, 可选)，图像在x轴、y轴原点附近的留白(padding)，该值越大，留白距离越大，图像远离坐标原点<br>10。kwds。与scatter_matrix函数本身相关的字典参数<br>11。c。颜色</p>
</blockquote>
<p>画直方图，<strong>查看分布对比图</strong></p>
<pre class="line-numbers language-python"><code class="language-python">画子图，查看分布对比图
data_temp <span class="token operator">=</span> data
<span class="token comment" spellcheck="true"># 分布对比图</span>
<span class="token keyword">def</span> <span class="token function">fea_diff</span><span class="token punctuation">(</span>label<span class="token punctuation">,</span>fea<span class="token punctuation">,</span>fea_name<span class="token punctuation">,</span>bins<span class="token punctuation">,</span>ran<span class="token punctuation">,</span>ran_limit<span class="token punctuation">,</span>log<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'fea'</span><span class="token punctuation">:</span>fea<span class="token punctuation">,</span><span class="token string">'label'</span><span class="token punctuation">:</span>label<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true">#nrows, ncols : int, optional, default: 1  Number of rows/columns of the subplot grid.</span>
    <span class="token comment" spellcheck="true">#True or 'all': x- or y-axis will be shared among all subplots.</span>

    fig<span class="token punctuation">,</span><span class="token punctuation">(</span>ax0<span class="token punctuation">,</span>ax1<span class="token punctuation">)</span> <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span> nrows<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>sharex<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>figsize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true">#调整子图位置</span>
    plt<span class="token punctuation">.</span>subplots_adjust<span class="token punctuation">(</span>hspace<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    data <span class="token operator">=</span> data<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> ran_limit<span class="token operator">==</span><span class="token boolean">False</span><span class="token punctuation">:</span>
        ran <span class="token operator">=</span> <span class="token punctuation">[</span>min<span class="token punctuation">(</span>data<span class="token punctuation">.</span>fea<span class="token punctuation">)</span><span class="token punctuation">,</span>max<span class="token punctuation">(</span>data<span class="token punctuation">.</span>fea<span class="token punctuation">)</span><span class="token punctuation">]</span> 
    <span class="token comment" spellcheck="true">#画直方图    </span>
     <span class="token comment" spellcheck="true">#x : (n,) array or sequence of (n,) arrays    </span>
     <span class="token comment" spellcheck="true"># bins : int or sequence or str, optional    </span>
    ax0<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>label<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'fea'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>bins<span class="token operator">=</span>bins<span class="token punctuation">,</span>alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>range<span class="token operator">=</span>ran<span class="token punctuation">,</span>normed <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span>log<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    ax0<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    ax0<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'label = 1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>loc <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    ax0<span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>labelsize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>
    ax0<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>

    ax1<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>label<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'fea'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'r'</span><span class="token punctuation">,</span>bins<span class="token operator">=</span>bins<span class="token punctuation">,</span>alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span>range<span class="token operator">=</span>ran<span class="token punctuation">,</span>normed <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span>log<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    ax1<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span>fea_name<span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    ax1<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    ax1<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'label = 0'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>loc <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">,</span>fontsize<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
    ax1<span class="token punctuation">.</span>tick_params<span class="token punctuation">(</span>labelsize <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span>
    ax1<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token punctuation">)</span>



fea_diff<span class="token punctuation">(</span>label <span class="token operator">=</span> <span class="token punctuation">(</span>data_temp<span class="token punctuation">.</span>loan_cur_balance<span class="token operator">&lt;</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true">#标签列</span>
         fea <span class="token operator">=</span> data_temp<span class="token punctuation">.</span>loan_cur_balance<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">#特征列</span>
         fea_name <span class="token operator">=</span> <span class="token string">'loan_cur'</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">#特征名</span>
         bins <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">#分桶数</span>
         ran_limit<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">#是否启用范围限制</span>
         ran <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">#数据范围</span>
         log <span class="token operator">=</span> <span class="token boolean">False</span> <span class="token comment" spellcheck="true">#是否对纵轴取对数</span>
         <span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a href="https://blog.csdn.net/weixin_29696999/article/details/113508821?spm=1001.2101.3001.6650.3&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-3.opensearchhbase&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7Edefault-3.opensearchhbase" target="_blank" rel="noopener">python双重直方图_Python – 使用散点图堆叠两个直方图</a></p>
<h3 id="OpenCV"><a href="#OpenCV" class="headerlink" title="OpenCV"></a>OpenCV</h3><p><a href="https://opencv.org/releases/" target="_blank" rel="noopener">opencv官网下载</a></p>
<blockquote>
<p>太慢了直接github下载源码编译或者exe</p>
</blockquote>
<p><a href="https://cloud.tencent.com/developer/article/1600575" target="_blank" rel="noopener">VS2019配置opencv工程文件</a></p>
<p><strong>验证一：人脸检测</strong></p>
<p>搞了半天环境纯属浪费时间然后照着他们做好了的做一遍很快。</p>
<p><strong>验证实验二：人脸检测分类器</strong></p>
<p>没看明白文件在哪，问了才知道是在opencv文件夹里v14下的exe示例</p>
<pre><code>opencv_createsamples.exe -info positives/trainpos.txt -vec data/positives.vec -num 100 -w 20 -h 20

opencv_traincascade.exe -data data/cascade -vec data/positives.vec -bg trainneg.txt -numPos 100 -numNeg 60 -nstages 10 -mem 600 -mode ALL -w 20 -h 20

</code></pre><p>级联分类器训练：OpenCV 3.4.8</p>
<p><a href="https://blog.csdn.net/qq_38236355/article/details/92794962" target="_blank" rel="noopener">CSDN一篇搞定所有报错</a></p>
<p>基本上把所有报错踩了一遍，又是改参数名又是改路径的。</p>
<p>如果出现 <strong>Parameters can not be written, because file xml/params.xml can not be opened</strong> 错误，则自己需要手动创建一个文件夹xml；</p>
<pre><code>opencv_visualisation --image=test/lena.jpg --model=data/cascade/cascade.xml --data=data/result/</code></pre><p>测试完成，由于图片数据太少结果毫无用处。</p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112111530190.png" alt="Snipaste_2021-12-11_15-30-03"></p>
<p>可以看到左上角有一个小框，不仔细看还真看不到。</p>
<p><strong>验证实验三</strong></p>
<p>1.增加实验样本进行测试。</p>
<p>2.自己选检测目标，仿照上述步骤训练。把垃圾识别的小程序做起来。</p>
<hr>
<h2 id="实验二-贝叶斯决策"><a href="#实验二-贝叶斯决策" class="headerlink" title="实验二 贝叶斯决策"></a>实验二 贝叶斯决策</h2><blockquote>
<p>课前小问题：如果有一种病，发病率是十万分之一，有一种试剂可以检测是否患病，正确率可达99%，那么如果开展全民筛查，查到某个人检测结果阳性的时候，这个人真的得病的概率多大？</p>
<p>#欢迎大家把答案写在回复中[偷笑]</p>
<p>虽然贝叶斯算出来是0.0989%，直觉告诉你很反常对吧，但确实就是这样。是不是感觉“正确率”不是很严谨，我也是，所以就不填正确答案哈哈哈。看到知乎有相关的问题，找到了下面第一个专业的关于检验学的回答，解决了我的疑问。即正确率在没有特别定义的情况下说的显然是这么一个意思——我测了很多个，这些人中我测对的占95%。所以0.0989%就是正确答案。</p>
<p>“你发现问题了吗？发现问题了吗？</p>
<p>另外你的问题中，有一个很关键的点叫做正确率。我不得不说，我没见过哪个检测疾病的正规说法里会提“正确率”的。我听到的都是什么假阳率，漏诊率，误诊率诸如此类的。</p>
<p>先跟你说一下为了衡量一个检测手段的效用，我们提出了多少标准，不是一个“正确率”可以泛泛谈之的。比较常用的大概有：灵敏度和特异度，漏诊率和误诊率。”</p>
<hr>
<p>一道关于疾病检验的概率的问题？ - 大汤圆的回答 - 知乎 <a href="https://www.zhihu.com/question/60562939/answer/178476420" target="_blank" rel="noopener">https://www.zhihu.com/question/60562939/answer/178476420</a></p>
<p>一道关于疾病检验的概率的问题？ - 彭铭燃的回答 - 知乎 <a href="https://www.zhihu.com/question/60562939/answer/177546247" target="_blank" rel="noopener">https://www.zhihu.com/question/60562939/answer/177546247</a></p>
</blockquote>
<hr>
<h3 id="（1）应用单个特征进行实验"><a href="#（1）应用单个特征进行实验" class="headerlink" title="（1）应用单个特征进行实验"></a>（1）应用单个特征进行实验</h3><p>以(a)身高、(b)体重或(c)鞋码尺寸数据作为特征，在正态分布假设下利用<strong>最大似然法</strong>或者贝叶斯估计法估计分布密度参数（只利用训练数据估计密度），建立最小错误率<strong>Bayes</strong> 分类器，写出得到的决策规则，将该分类器应用到测试样本，考察测试错误情况。在分类器设计时可以考察采用不同先验概率（如<strong>0.5</strong> 对<strong>0.5, 0.75</strong> 对<strong>0.25, 0.9</strong> 对<strong>0.1</strong> 等）进行实验，考察对决策规则和错误率的影响。</p>
<blockquote>
<p>《机器学习实战》是将数据离散化做的贝叶斯分类器，用频率替代了概率，这里使用概率估计方法做一下。</p>
</blockquote>
<blockquote>
<p>这里出大问题，在画ROC曲线的时候才反应过来，先验概率首先应该是数据</p>
</blockquote>
<h4 id="正态分布"><a href="#正态分布" class="headerlink" title="正态分布"></a>正态分布</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> scipy<span class="token punctuation">.</span>stats <span class="token keyword">import</span> norm
prob <span class="token operator">=</span> norm<span class="token punctuation">.</span>pdf<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">-</span>mu<span class="token punctuation">)</span><span class="token operator">/</span>sigma<span class="token punctuation">)</span><span class="token operator">/</span>sigma
cdf <span class="token operator">=</span> norm<span class="token punctuation">.</span>cdf<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">-</span>mu<span class="token punctuation">)</span><span class="token operator">/</span>sigma<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>总觉得哪里不对，果然，参数是标准差</p>
<p>np.var是方差，np.std才是标准差，好在查了一手，感觉自己变谨慎了。</p>
</blockquote>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112191051223.png" alt="全体男生女生身高正态分布概率密度函数"></p>
<h4 id="测试样本与训练样本的划分"><a href="#测试样本与训练样本的划分" class="headerlink" title="测试样本与训练样本的划分"></a>测试样本与训练样本的划分</h4><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split
<span class="token comment" spellcheck="true">#data:需要进行分割的数据集</span>
<span class="token comment" spellcheck="true">#random_state:设置随机种子，保证每次运行生成相同的随机数</span>
<span class="token comment" spellcheck="true">#test_size:将数据分割成训练集的比例</span>
train_set<span class="token punctuation">,</span> test_set <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>data<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>然而我们知道计算机学院以前都是阳盛阴衰，因此样本类别标签不均匀，如果我们通过<strong>随机采样</strong>的方式，极端情况下可能将正例样本（男生）都划分到训练集上，而反例样本（女生）恰好都分到测试集，这样训练出来的模型，效果一定不会太好，所以我们需要采用<strong>分层采样</strong>的方式进行划分数据集，也就是说保证训练集中既包含一定比例的正例样本又要包含一定比例的负例样本。</p>
<p>幸运的是sklearn提供了我们分层抽样的函数，在这之前先看看官方提供的例子：</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> StratifiedShuffleSplit
X <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
split <span class="token operator">=</span> StratifiedShuffleSplit<span class="token punctuation">(</span>n_splits<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>split <span class="token punctuation">)</span>       <span class="token comment" spellcheck="true"># doctest: +ELLIPSIS</span>

<span class="token comment" spellcheck="true"># StratifiedShuffleSplit(n_splits=3, random_state=0, ...)</span>
<span class="token keyword">for</span> train_index<span class="token punctuation">,</span> test_index <span class="token keyword">in</span> split<span class="token punctuation">.</span>split<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"TRAIN:"</span><span class="token punctuation">,</span> train_index<span class="token punctuation">,</span> <span class="token string">"TEST:"</span><span class="token punctuation">,</span> test_index<span class="token punctuation">)</span>
    X_train<span class="token punctuation">,</span> X_test <span class="token operator">=</span> X<span class="token punctuation">[</span>train_index<span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>test_index<span class="token punctuation">]</span>
    y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> y<span class="token punctuation">[</span>train_index<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>test_index<span class="token punctuation">]</span>

<span class="token triple-quoted-string string">"""
StratifiedShuffleSplit(n_splits=3, random_state=0, test_size=0.5,train_size=None)
TRAIN: [1 2] TEST: [3 0]
TRAIN: [0 2] TEST: [1 3]
TRAIN: [0 2] TEST: [3 1]
"""</span>
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> StratifiedShuffleSplit

split <span class="token operator">=</span> StratifiedShuffleSplit<span class="token punctuation">(</span>n_splits <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span>random_state <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">#根据mnist["target"]来进行分层采样</span>
<span class="token keyword">for</span> train_index<span class="token punctuation">,</span>test_index <span class="token keyword">in</span> split<span class="token punctuation">.</span>split<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    train_set <span class="token operator">=</span> data<span class="token punctuation">[</span>train_index<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    test_set <span class="token operator">=</span> data<span class="token punctuation">[</span>test_index<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>train_set<span class="token punctuation">)</span><span class="token punctuation">,</span>len<span class="token punctuation">(</span>test_set<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token triple-quoted-string string">"""
56000 14000
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>通过上面的例子我们可以了解使用分层进行划分数据集的大概流程，以及各个参数的含义：</p>
<ul>
<li>n_splits：分割迭代的次数，如果我们要划分训练集和测试集的话，将其设置为1即可；</li>
<li>test_size：分割测试集的比例；</li>
<li>random_state：设置随机种子；</li>
</ul>
<blockquote>
<p>然而不如直接在train_test_split加<strong><em>stratify=y</em></strong>方便</p>
<p><a href="https://www.cnblogs.com/Yanjy-OnlyOne/p/11288098.html" target="_blank" rel="noopener">sklearn的train_test_split()各函数参数含义解释（非常全）</a></p>
</blockquote>
<hr>
<h4 id="最大似然估计"><a href="#最大似然估计" class="headerlink" title="最大似然估计"></a>最大似然估计</h4><blockquote>
<p>这边做的都是用最大似然估计</p>
</blockquote>
<hr>
<h4 id="贝叶斯估计"><a href="#贝叶斯估计" class="headerlink" title="贝叶斯估计"></a>贝叶斯估计</h4><blockquote>
<p>最后又研究了半天，然后zxy那边实现了一下发现错误率堪比我那个离谱的最小风险贝叶斯分类器，他说是数据样本太少的原因，对参数的估计不够准确，我觉得可能还有别的原因，或许是对假设的理解出了问题。</p>
</blockquote>
<hr>
<h4 id="模型测试结果"><a href="#模型测试结果" class="headerlink" title="模型测试结果"></a><strong>模型测试结果</strong></h4><h5 id="错误率"><a href="#错误率" class="headerlink" title="错误率"></a>错误率</h5><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">modelTests</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># 测试模型</span>
    featureList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">,</span> <span class="token string">'weight'</span><span class="token punctuation">,</span> <span class="token string">'footsize'</span><span class="token punctuation">]</span>
    pBoyList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span>
    error_result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>featureList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        error_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>pBoyList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            singleFeature <span class="token operator">=</span> featureList<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            pBoy <span class="token operator">=</span> pBoyList<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
            girlConProFunc<span class="token punctuation">,</span> boyConProFunc <span class="token operator">=</span> trainNB1<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> singleFeature<span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true"># 测试单一特征模型性能</span>
            error <span class="token operator">=</span> testModel1<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> girlConProFunc<span class="token punctuation">,</span> boyConProFunc<span class="token punctuation">,</span> pBoy<span class="token punctuation">,</span> singleFeature<span class="token punctuation">)</span>
            error_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>error<span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true"># print("The Model error rate is ",error)</span>
        error_result<span class="token punctuation">.</span>append<span class="token punctuation">(</span>error_list<span class="token punctuation">)</span>
    result_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>error_result<span class="token punctuation">,</span> index<span class="token operator">=</span>featureList<span class="token punctuation">,</span> columns<span class="token operator">=</span>pBoyList<span class="token punctuation">)</span>
    result_df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">"result1.csv"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112252112112.jpg" alt="实验二模型测试结果"></p>
<h5 id="决策面"><a href="#决策面" class="headerlink" title="决策面"></a>决策面</h5><p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112252113328.jpg" alt="singleF_Dserfaces"></p>
<blockquote>
<p>可以看到，先验概率对决策面的影响，当男生先验概率与训练数据先验概率越接近时（即接近真实分布，模型拟合效果越来越好）</p>
</blockquote>
<p>用sympy解方程求解决策面</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">randomcolor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    python随机生成颜色
    :return:
    """</span>
    colorArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token string">'6'</span><span class="token punctuation">,</span> <span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token string">'8'</span><span class="token punctuation">,</span> <span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">]</span>
    color <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        color <span class="token operator">+=</span> colorArr<span class="token punctuation">[</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token string">"#"</span> <span class="token operator">+</span> color

<span class="token keyword">def</span> <span class="token function">getDecisionSurface1</span><span class="token punctuation">(</span>pBoy_choice<span class="token punctuation">,</span>feature_choice<span class="token punctuation">,</span>ax<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    找决策面
    TODO:决策面可视化
    :return:
    """</span>
    featureList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">,</span> <span class="token string">'weight'</span><span class="token punctuation">,</span> <span class="token string">'footsize'</span><span class="token punctuation">]</span>
    pBoyList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span>
    pBoy <span class="token operator">=</span> pBoyList<span class="token punctuation">[</span>pBoy_choice<span class="token punctuation">]</span>
    singleFeature <span class="token operator">=</span> featureList<span class="token punctuation">[</span>feature_choice<span class="token punctuation">]</span>
    <span class="token comment" spellcheck="true"># plot single feature decision facet</span>

    mu0<span class="token punctuation">,</span> std0 <span class="token operator">=</span> getNormArg<span class="token punctuation">(</span>dataDf<span class="token punctuation">[</span>singleFeature<span class="token punctuation">]</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span>dataDf<span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    mu1<span class="token punctuation">,</span> std1 <span class="token operator">=</span> getNormArg<span class="token punctuation">(</span>dataDf<span class="token punctuation">[</span>singleFeature<span class="token punctuation">]</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span>dataDf<span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    sigma<span class="token punctuation">,</span> mu<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> sy<span class="token punctuation">.</span>symbols<span class="token punctuation">(</span><span class="token string">"sigma,mu, x,y"</span><span class="token punctuation">)</span>

    p <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>sigma <span class="token operator">*</span> sy<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> sy<span class="token punctuation">.</span>pi<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> sy<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">-</span> mu<span class="token punctuation">)</span> <span class="token operator">/</span> sigma<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>
    f1 <span class="token operator">=</span> p<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>mu<span class="token punctuation">,</span> mu0<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sigma<span class="token punctuation">,</span> std0<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    f2 <span class="token operator">=</span> p<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>mu<span class="token punctuation">,</span> mu1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sigma<span class="token punctuation">,</span> std1<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    solve_x <span class="token operator">=</span> sy<span class="token punctuation">.</span>solveset<span class="token punctuation">(</span>sy<span class="token punctuation">.</span>Eq<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> pBoy<span class="token punctuation">)</span> <span class="token operator">*</span> f1<span class="token punctuation">,</span> pBoy <span class="token operator">*</span> f2<span class="token punctuation">)</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
    x_list <span class="token operator">=</span> list<span class="token punctuation">(</span>solve_x<span class="token punctuation">)</span>
    x <span class="token operator">=</span> <span class="token punctuation">[</span>d <span class="token keyword">for</span> d <span class="token keyword">in</span> x_list <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>d <span class="token operator">>=</span> <span class="token punctuation">(</span>min<span class="token punctuation">(</span>mu1<span class="token number">-3</span><span class="token operator">*</span>std1<span class="token punctuation">,</span> mu0<span class="token number">-3</span><span class="token operator">*</span>std0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span>d <span class="token operator">&lt;=</span> max<span class="token punctuation">(</span>mu0<span class="token operator">+</span><span class="token number">3</span><span class="token operator">*</span>std0<span class="token punctuation">,</span> mu1<span class="token operator">+</span><span class="token number">3</span><span class="token operator">*</span>std1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment" spellcheck="true"># 求解方程多解需给定范围</span>

    plotPdf<span class="token punctuation">(</span>mu0<span class="token punctuation">,</span> std0<span class="token punctuation">,</span> ax<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> pBoy<span class="token punctuation">)</span><span class="token punctuation">)</span>
    plotPdf<span class="token punctuation">(</span>mu1<span class="token punctuation">,</span> std1<span class="token punctuation">,</span> ax<span class="token punctuation">,</span> pBoy<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>axvline<span class="token punctuation">(</span>x<span class="token punctuation">,</span> ls<span class="token operator">=</span><span class="token string">"-"</span><span class="token punctuation">,</span> c<span class="token operator">=</span>randomcolor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 添加垂直直线决策面</span>
    ax<span class="token punctuation">.</span>grid<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># ax.legend(["girl", "boy", "decision surface"])</span>
    <span class="token comment" spellcheck="true"># ax.title(singleFeature + "pBoy")</span>

<span class="token keyword">def</span> <span class="token function">allSingleFeatureDSurface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># 直接多图全部画出来</span>
    <span class="token comment" spellcheck="true"># fig = plt.figure()</span>
    <span class="token comment" spellcheck="true"># ax = fig.add_subplot(111)</span>
    fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            getDecisionSurface1<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> ax<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># plt.title("All single feature decision serfaces",loc="center")</span>
    plt<span class="token punctuation">.</span>suptitle<span class="token punctuation">(</span><span class="token string">"All single feature decision serfaces"</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./singleF_Dserfaces.jpg'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="混淆矩阵"><a href="#混淆矩阵" class="headerlink" title="混淆矩阵"></a>混淆矩阵</h5><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">testModel2</span><span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> girlConProFunc<span class="token punctuation">,</span> boyConProFunc<span class="token punctuation">,</span> pBoy<span class="token punctuation">,</span> singleFeature<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    测试模型给出混淆矩阵
    Parameters:
        X_test - 测试集
        girlConProFunc - 女生类条件概率
        boyConProFunc - 男生类条件概率
        pBoy - 男生先验概率
        singleFeature - 单一特征名
    :return: TP,FP,FN,TN
    TP = True Postive = 真阳性； FP = False Positive = 假阳性
    FN = False Negative = 假阴性； TN = True Negative = 真阴性
    """</span>
    TP <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    FP <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    FN <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    TN <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    lenOfX_test <span class="token operator">=</span> len<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
    <span class="token keyword">for</span> test_id <span class="token keyword">in</span> range<span class="token punctuation">(</span>lenOfX_test<span class="token punctuation">)</span><span class="token punctuation">:</span>
        testsample <span class="token operator">=</span> X_test<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>test_id<span class="token punctuation">]</span>
        result_gender <span class="token operator">=</span> classifyNB1<span class="token punctuation">(</span>testsample<span class="token punctuation">,</span> girlConProFunc<span class="token punctuation">,</span> boyConProFunc<span class="token punctuation">,</span> pBoy<span class="token punctuation">,</span> singleFeature<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>testsample<span class="token punctuation">[</span><span class="token string">"gender"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result_gender <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                TP <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result_gender <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                FP <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result_gender <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                FN <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result_gender <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                TN <span class="token operator">+=</span> <span class="token number">1</span>
    precision <span class="token operator">=</span> TP <span class="token operator">/</span> <span class="token punctuation">(</span>TP <span class="token operator">+</span> FP<span class="token punctuation">)</span>
    recall <span class="token operator">=</span> TP <span class="token operator">/</span> <span class="token punctuation">(</span>TP <span class="token operator">+</span> FN<span class="token punctuation">)</span>
    specificity <span class="token operator">=</span> TN <span class="token operator">/</span> <span class="token punctuation">(</span>TN <span class="token operator">+</span> FP<span class="token punctuation">)</span>
    F1 <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> TP <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> TP <span class="token operator">+</span> FP <span class="token operator">+</span> FN<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"==========The Model confusion matrix=========="</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"total num:"</span><span class="token punctuation">,</span> lenOfX_test<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"\t\t"</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">,</span> TP<span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">,</span> FP<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">,</span> FN<span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">,</span> TN<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=============================================="</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"precision:"</span><span class="token punctuation">,</span>precision<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"recall:"</span><span class="token punctuation">,</span>recall<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"specificity:"</span><span class="token punctuation">,</span>specificity<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"F1:"</span><span class="token punctuation">,</span>F1<span class="token punctuation">)</span>
    <span class="token keyword">return</span> TP<span class="token punctuation">,</span> FP<span class="token punctuation">,</span> FN<span class="token punctuation">,</span> TN

<span class="token keyword">def</span> <span class="token function">confusionMatrix1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    featureList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">,</span> <span class="token string">'weight'</span><span class="token punctuation">,</span> <span class="token string">'footsize'</span><span class="token punctuation">]</span>
    pBoyList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span>
    singleFeature<span class="token operator">=</span>featureList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    pBoy<span class="token operator">=</span>pBoyList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token comment" spellcheck="true"># 训练单一特征贝叶斯分类器模型</span>
    girlConProFunc<span class="token punctuation">,</span> boyConProFunc <span class="token operator">=</span> trainNB1<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> singleFeature<span class="token punctuation">)</span>
    testModel2<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> girlConProFunc<span class="token punctuation">,</span> boyConProFunc<span class="token punctuation">,</span> pBoy<span class="token punctuation">,</span> singleFeature<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>精度(precision, 或者PPV, positive predictive value) = TP / (TP + FP)</strong></p>
<p><strong>召回(recall, 或者敏感度，sensitivity，真阳性率，TPR，True Positive Rate) = TP / (TP + FN)</strong></p>
<p><strong>特异度(specificity，或者真阴性率，TNR，True Negative Rate) = TN / (TN + FP)</strong></p>
<p><strong>F1-值(F1-score) = 2*TP / (2*TP+FP+FN)</strong></p>
<pre><code>==========The Model confusion matrix==========
total num: 252
       1          0
1      154      19
0      10      69
==============================================
precision: 0.8901734104046243
recall: 0.9390243902439024
specificity: 0.7840909090909091
F1: 0.913946587537092
</code></pre><hr>
<h5 id="ROC曲线"><a href="#ROC曲线" class="headerlink" title="ROC曲线"></a>ROC曲线</h5><p>roc曲线怎么画？ - 争取一遍过的大喵的回答 - 知乎 <a href="https://www.zhihu.com/question/22844912/answer/246037337" target="_blank" rel="noopener">https://www.zhihu.com/question/22844912/answer/246037337</a></p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112261142339.jpg" alt="身高最小错误率贝叶斯分类器ROC_Curve1"></p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">ROC1</span><span class="token punctuation">(</span>pBoy_choice<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> feature1_choice<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    画ROC曲线，参数同决策面选择不同模型
    :return:
    """</span>
    featureList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">,</span> <span class="token string">'weight'</span><span class="token punctuation">,</span> <span class="token string">'footsize'</span><span class="token punctuation">]</span>
    pBoyList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span>
    singleFeature <span class="token operator">=</span> featureList<span class="token punctuation">[</span>feature1_choice<span class="token punctuation">]</span>
    pBoy <span class="token operator">=</span> pBoyList<span class="token punctuation">[</span>pBoy_choice<span class="token punctuation">]</span>
    <span class="token comment" spellcheck="true"># 获取测试集真实分类</span>
    gender_list <span class="token operator">=</span> X_test<span class="token punctuation">[</span><span class="token string">"gender"</span><span class="token punctuation">]</span>
    girl_num <span class="token operator">=</span> gender_list<span class="token punctuation">[</span>gender_list <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
    boy_num <span class="token operator">=</span> gender_list<span class="token punctuation">[</span>gender_list <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># 训练单一特征贝叶斯分类器模型</span>
    girlConProFunc<span class="token punctuation">,</span> boyConProFunc <span class="token operator">=</span> trainNB1<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> singleFeature<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">getScore</span><span class="token punctuation">(</span>featureData2score<span class="token punctuation">)</span><span class="token punctuation">:</span>
        score <span class="token operator">=</span> boyConProFunc<span class="token punctuation">(</span>featureData2score<span class="token punctuation">)</span> <span class="token operator">*</span> pBoy
        <span class="token keyword">return</span> score

    <span class="token comment" spellcheck="true"># X_test_copy=X_test</span>
    lenOfX_test <span class="token operator">=</span> len<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
    score_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> test_id <span class="token keyword">in</span> range<span class="token punctuation">(</span>lenOfX_test<span class="token punctuation">)</span><span class="token punctuation">:</span>
        testsample <span class="token operator">=</span> X_test<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>test_id<span class="token punctuation">]</span>
        testsample_score <span class="token operator">=</span> getScore<span class="token punctuation">(</span>testsample<span class="token punctuation">[</span>singleFeature<span class="token punctuation">]</span><span class="token punctuation">)</span>
        score_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>testsample_score<span class="token punctuation">)</span>

    arg_sort_index <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>score_list<span class="token punctuation">)</span>
    arg_sort_index_list <span class="token operator">=</span> arg_sort_index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 从大到小的index</span>
    arg_sort_index_list <span class="token operator">=</span> list<span class="token punctuation">(</span>reversed<span class="token punctuation">(</span>arg_sort_index_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># X_test_copy=X_test_copy[arg_sort_index]</span>

    FPR_x_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    TPR_y_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> roc_i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> lenOfX_test<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 第roc_i+1大的score，判断为阳性的数目=roc_i+1，阴性数目为=lenOfX_test-(roc_i+1)</span>
        <span class="token comment" spellcheck="true"># roc_i=10</span>
        threshold <span class="token operator">=</span> score_list<span class="token punctuation">[</span>roc_i<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 设置阈值</span>

        max_score_index_list <span class="token operator">=</span> arg_sort_index_list<span class="token punctuation">[</span><span class="token punctuation">:</span>roc_i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 取前roc_i+1个score值的index，即判断为阳性的样本</span>
        hypo_boy_gender_list <span class="token operator">=</span> gender_list<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>max_score_index_list<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 忘记reverse了，结果全是女生。这是判成男生的样本index列表</span>
        hypo_boy_num <span class="token operator">=</span> hypo_boy_gender_list<span class="token punctuation">[</span>hypo_boy_gender_list <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 错判成男生的女生数目</span>
        <span class="token comment" spellcheck="true"># 判断FP</span>
        FP <span class="token operator">=</span> hypo_boy_num <span class="token operator">/</span> girl_num
        <span class="token comment" spellcheck="true"># 判断TP</span>
        TP <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>roc_i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> hypo_boy_num<span class="token punctuation">)</span> <span class="token operator">/</span> boy_num
        FPR_x_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>FP<span class="token punctuation">)</span>
        TPR_y_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>TP<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># FPR_x_list.append(1.0)</span>
    <span class="token comment" spellcheck="true"># TPR_y_list.append(1.0)</span>
    AUC <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>FPR_x_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        AUC <span class="token operator">=</span> AUC <span class="token operator">+</span> <span class="token punctuation">(</span>FPR_x_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> FPR_x_list<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>TPR_y_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> TPR_y_list<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'ROC Curve'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>FPR_x_list<span class="token punctuation">,</span> TPR_y_list<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'ROC(AUC={:.6f})'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>AUC<span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Random Guess'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'False Positive Rate'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'True Positive Rate'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./ROC_Curve1.jpg'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112291929815.jpg" alt="All_ROC_Curve1"></p>
<blockquote>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzI4MDE1NjExMQ==&mid=2247486137&idx=1&sn=abbc4f6c241a812dcfec690ed3431a25&scene=19#wechat_redirect" target="_blank" rel="noopener">一文深度解读模型评估方法</a></p>
<p>先验概率对ROC曲线无影响，也不需要估计正态分布来得到类条件概率密度，ROC是为了找到最佳阈值来确定</p>
<p><strong>AUC不依赖分类阈值，摆脱了固定分类阈值看分类效果的局限性。</strong></p>
<p><strong>简单来说：AUC对样本的正负比例情况是不敏感，即使正例与负例的比例发生了很大变化，ROC曲线面积也不会产生大的变化</strong></p>
<p>ROC曲线有个很好的特性：当测试集中的正负样本的分布变化的时候，ROC曲线能够保持不变。在实际的数据集中经常会出现类不平衡（class imbalance）现象，即负样本比正样本多很多（或者相反），而且测试数据中的正负样本的分布也可能随着时间变化。</p>
</blockquote>
<hr>
<h5 id="PR曲线"><a href="#PR曲线" class="headerlink" title="PR曲线"></a>PR曲线</h5><blockquote>
<p>直接使用plot_precision_recall_curve函数绘制PR曲线，但是自己也可以实现一下，应该也很快。</p>
<p>from sklearn.metrics import plot_precision_recall_curve<br>disp = plot_precision_recall_curve(classifier, X_test, y_test)<br>disp.ax_.set_title(‘2-class Precision-Recall curve’)</p>
<p>终于搞懂了PR曲线 - yfor的文章 - 知乎 <a href="https://zhuanlan.zhihu.com/p/404798546" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/404798546</a></p>
</blockquote>
<p>P-R曲线就是精确率precision vs 召回率recall 曲线，以recall作为横坐标轴，precision作为纵坐标轴。首先解释一下精确率和召回率。不过在解释精确率和召回率之前，先来看下混淆矩阵，</p>
<table>
<thead>
<tr>
<th>预测\真实</th>
<th>正</th>
<th>负</th>
</tr>
</thead>
<tbody><tr>
<td>正</td>
<td>TP</td>
<td>FP</td>
</tr>
<tr>
<td>负</td>
<td>FN</td>
<td>TN</td>
</tr>
</tbody></table>
<p>把正例正确分类为正例，表示为TP（true positive），把正例错误分类为负例，表示为FN（false negative），</p>
<p>把负例正确分类为负例，表示为TN（true negative）， 把负例错误分类为正例，表示为FP（false positive）</p>
<p>精确率和召回率可以从混淆矩阵中计算而来，precision = TP/(TP + FP), recall = TP/(TP +FＮ)。那么P-R曲线是怎么来的呢？</p>
<p>算法对样本进行分类时，一般都会有置信度，即表示该样本是正样本的概率，比如99%的概率认为样本Ａ是正例，１％的概率认为样本B是正例。通过选择合适的阈值，比如50%，对样本进行划分，概率大于50%的就认为是正例，小于50%的就是负例。</p>
<p>通过置信度就可以对所有样本进行排序，再逐个样本的选择阈值，在该样本之前的都属于正例，该样本之后的都属于负例。每一个样本作为划分阈值时，都可以计算对应的precision和recall，那么就可以以此绘制曲线。</p>
<p>————————————————<br>版权声明：本文为CSDN博主「keep_forward」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/b876144622/article/details/80009867" target="_blank" rel="noopener">https://blog.csdn.net/b876144622/article/details/80009867</a></p>
<blockquote>
<p>仔细琢磨会发现这些图的规律和问题，比如西瓜书上的PR曲线</p>
</blockquote>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112310928240.png" alt="西瓜书上的PR曲线"></p>
<blockquote>
<p>下面是我自己画的PR曲线</p>
</blockquote>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112310923005.jpg" alt="All_PR_Curve1"></p>
<blockquote>
<p>女生人数太少，准确率降不到0。</p>
<p>曲线最终不会到（1,0）点。很多P-R曲线的终点看着都是（1,0）点，这可能是因为负例远远多于正例。</p>
<p>最后一个点表示所有的样本都被判为正例，因此FN=0，所以recall = TP/(TP + FN) = 1, 而FP = 所有的负例样本数，因此precision = TP/(TP+FP) = 正例的占所有样本的比例，故除非负例数很多，否则precision不会为0.</p>
<p>另外，如果有个划分点可以把正负样本完全区分开，那么P-R曲线就是整个1*1的面积。</p>
<p>总之，P-R曲线应该是从（0,0）开始画的一条曲线，切割1*1的正方形，得到一块区域。</p>
</blockquote>
<p>还有一些补充，与ROC曲线对比，PR曲线对样本不均衡敏感。</p>
<blockquote>
<p>在众多学习器对数据进行学习后，如果其中一个学习器的PR曲线A完全包住另一个学习器B的PR曲线，则可断言A的性能优于B。但是A和B发生交叉，那性能该如何判断呢？我们可以根据曲线下方的面积大小来进行比较，但更常用的是平衡点F1。平衡点（BEP）是P=R时的取值（斜率为1），F1值越大，我们可以认为该学习器的性能较好。F1的计算如下所示：<br>F1 = 2 <em> P </em> R ／( P + R )<br>————————————————<br>版权声明：本文为CSDN博主「gz7seven」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/guzhao9901/article/details/107961184" target="_blank" rel="noopener">https://blog.csdn.net/guzhao9901/article/details/107961184</a></p>
</blockquote>
<hr>
<h5 id="代价曲线"><a href="#代价曲线" class="headerlink" title="代价曲线"></a>代价曲线</h5><blockquote>
<p>没画了，不知道怎么算风险的那块面积，怎么取直线交点？</p>
</blockquote>
<hr>
<h3 id="（2）应用两个特征进行实验"><a href="#（2）应用两个特征进行实验" class="headerlink" title="（2）应用两个特征进行实验"></a>（2）应用两个特征进行实验</h3><p>同时采用<strong>身高和体重</strong>数据作为特征，假设二者不相关，在正态分布假设下估计概率密度，建立最小错误率Bayes分类器，写出得到的<strong>决策规则</strong>，将该分类器应用到训练/测试样本，考察训练/测试错误情况。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">trainNB2</span><span class="token punctuation">(</span>trainMatrix<span class="token punctuation">,</span> feature_name1<span class="token punctuation">,</span> feature_name2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    函数说明:朴素贝叶斯分类器训练函数

    Parameters:
        trainMatrix - 训练数据，单一特征
        fearture_name1 - 特征名
        fearture_name2 - 特征名
    Returns:
        p0Func1 - 女生的某特征条件概率函数
        p1Func1 - 男生的某特征条件概率函数
        p0Func2 - 女生的某特征条件概率函数
        p1Func2 - 男生的某特征条件概率函数
    """</span>
    <span class="token comment" spellcheck="true"># Bayes Classifier</span>
    p0Func1<span class="token punctuation">,</span> p1Func1 <span class="token operator">=</span> trainNB1<span class="token punctuation">(</span>trainMatrix<span class="token punctuation">,</span> feature_name1<span class="token punctuation">)</span>
    p0Func2<span class="token punctuation">,</span> p1Func2 <span class="token operator">=</span> trainNB1<span class="token punctuation">(</span>trainMatrix<span class="token punctuation">,</span> feature_name2<span class="token punctuation">)</span>
    <span class="token keyword">return</span> p0Func1<span class="token punctuation">,</span> p1Func1<span class="token punctuation">,</span> p0Func2<span class="token punctuation">,</span> p1Func2

<span class="token keyword">def</span> <span class="token function">classifyNB2</span><span class="token punctuation">(</span>data2Classify<span class="token punctuation">,</span> p0Func1<span class="token punctuation">,</span> p1Func1<span class="token punctuation">,</span> p0Func2<span class="token punctuation">,</span> p1Func2<span class="token punctuation">,</span> pBoy<span class="token punctuation">,</span> feature_name1<span class="token punctuation">,</span> feature_name2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    函数说明:朴素贝叶斯分类器分类函数2

    Parameters:
        data2Classify - 待分类的新数据
        p0Func1 - 女生的身高条件概率函数
        p1Func1 - 男生的身高条件概率函数
        p0Func2 - 女生的体重条件概率函数
        p1Func2 - 男生的体重条件概率函数
        pBoy - 属于男生的先验概率
    Returns:
        0 - 属于女生
        1 - 属于男生
    """</span>
    height <span class="token operator">=</span> data2Classify<span class="token punctuation">[</span>feature_name1<span class="token punctuation">]</span>
    weight <span class="token operator">=</span> data2Classify<span class="token punctuation">[</span>feature_name2<span class="token punctuation">]</span>
    ln_p1 <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>p1Func1<span class="token punctuation">(</span>height <span class="token operator">+</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>p1Func2<span class="token punctuation">(</span>weight <span class="token operator">+</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>pBoy <span class="token operator">+</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>
    ln_p0 <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>p0Func1<span class="token punctuation">(</span>height <span class="token operator">+</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>p0Func2<span class="token punctuation">(</span>weight <span class="token operator">+</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">-</span> pBoy <span class="token operator">+</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> ln_p1 <span class="token operator">></span> ln_p0<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在分类器设计时可以考察采用不同先验概率（如0.5 vs. 0.5, 0.75 vs. 0.25, 0.9 vs. 0.1 等）进行实验，考察对决策规则和错误率的影响。</p>
<hr>
<h4 id="二维决策面"><a href="#二维决策面" class="headerlink" title="二维决策面"></a>二维决策面</h4><p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112261209094.png" alt="Figure_1"></p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112261917995.png" alt="pBoy=0.75"></p>
<blockquote>
<p>好像可以看出男女之间身高体重相关程度不同。也可能是比例尺度的关系。</p>
</blockquote>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112261935736.png" alt="p=0.5"></p>
<blockquote>
<p>画错了，还是得推导一下公式。不记得还有考虑先验概率了，上面画的默认男女概率1比1.</p>
<p>重来。</p>
<p>参考资料：<a href="https://blog.csdn.net/neu_chenguangq/article/details/79288905" target="_blank" rel="noopener">[贝叶斯七]之正态分布贝叶斯决策</a></p>
</blockquote>
<h4 id="多元正态分布"><a href="#多元正态分布" class="headerlink" title="多元正态分布"></a>多元正态分布</h4><ul>
<li>多变量pdf表达</li>
</ul>
<p>$$<br>p(x)=\frac{1}{(2 \pi)^{1 / 2}\left|\sum\right|^{1 / 2}} \exp \left\{-\frac{1}{2}(x-\mu)^{T} {\sum}^{-1}(x-\mu)\right\}, \quad x \in R^{l}<br>$$</p>
<ul>
<li>Mean Vector (均值)</li>
</ul>
<p>$$<br>\mu=E[x]=E\left[x_{1}, x_{2}, \ldots, x_{l}\right]<br>$$</p>
<ul>
<li>Convariance matrix (协方差矩阵)</li>
</ul>
<p>$$<br>\sum=E\left[(x-\mu)(x-\mu)^{T}\right]<br>$$</p>
<p>$$<br>=\left[\begin{array}{cccc}<br>\sigma_{11}^{2} &amp; \sigma_{12}^{2} &amp; \cdots &amp; \sigma_{1 l}^{2} \<br>\sigma_{21}^{2} &amp; \sigma_{22}^{2} &amp; \cdots &amp; \sigma_{2 l}^{2} \<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots \<br>\sigma_{l 1}^{2} &amp; \sigma_{l 2}^{2} &amp; \cdots &amp; \sigma_{l l}^{2}<br>\end{array}\right]<br>$$</p>
<ul>
<li>数学表达</li>
</ul>
<p>$$<br>p(x) N(\mu, \Sigma)<br>$$</p>
<p><strong>特点</strong></p>
<ul>
<li>K个参数(均值和方差)决定L−dim的正态分布</li>
</ul>
<p>$$<br>K=l+\frac{l（l+1）}{2}<br>$$</p>
<ul>
<li>协方差矩阵的特征向量决定主轴，而且主轴的长度和协方差矩阵的特征向量是成比例的。</li>
<li>超椭球面(super-ellipsoid)上点概率值相等</li>
<li>对于正态分布来说，不相关和独立是相等的</li>
<li>如果x是独立的，那么协方差矩阵是对角矩阵</li>
</ul>
<hr>
<h4 id="贝叶斯分类器理论推导"><a href="#贝叶斯分类器理论推导" class="headerlink" title="贝叶斯分类器理论推导"></a>贝叶斯分类器理论推导</h4><p>我们考虑每个类别数据都是服从正态分布的。同样的，我们判决函数用ln函数，那么我们能得到如下的决策函数。</p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112271543146.png" alt="image-20211227154312003"></p>
<p>然后，因为x是服从正态分布的，由此，我们将x的pdf函数带入到上式。得到如下式子。</p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112271543287.png" alt="公式（1）"></p>
<p>根据决策面方程（第i类和第j类的分界面）：<br>$$<br>g_{ij}(x)=g_i(x)-g_j(x)=0<br>$$<br>由此我们可以推导出决策面</p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112271534126.png" alt="决策面公式，显然是个二次曲面"></p>
<blockquote>
<p>在实际代码实现画决策面的投影时出现了问题，仔细琢磨一下公式发现如果是二元正态分布，可能出现多解和复数解，但大概很接近正确答案了。</p>
</blockquote>
<p>我们发现这个方程其实还是很难的，而且虽然每个类别样本都是服从正态分布，但是正态分布也会因为协方差矩阵不同而千差万别（就像单变量正态分布，如果方差不一样，那么他们之间的胖瘦就不一样）。不仅如此，多变量正态分布还存在属性之间的关系等等。所以，这里为了进一步分析上面的方程，就像朴素贝叶斯一样，我们也可以做一些强的假设。假设条件如下：</p>
<ul>
<li>假设协方差矩阵元素相等，而且是一个对角阵。即特征向量之间是相互独立的，方差相等。</li>
</ul>
<blockquote>
<p>然而实验条件假设身高体重不相关，但是男生类和女生类的身高或者体重方差会相同吗？那显然。。。。。。我们不知道。因为假设没说，虽然我们可以通过标准化把身高体重变成标准正态分布。但那只是改变了坐标轴的比例而已，好像没什么意思。</p>
<p>但为了美观，可以把方差标准化好，身高体重都除以自己的std标准差就行了。那样画出来的投影图就一定是书上标准的两个圆，两个圆心的垂直平分线就是决策面。</p>
<p>或者我们还可以乖乖照着公式，画出一般情况的多远正态分布。我是个很喜欢偷懒的人，所以喜欢一次性把事情做好。</p>
<p>下面是假设成立时的推导，把它推导完好了。</p>
</blockquote>
<ul>
<li>因为每个类别的协方差矩阵相等，我们可以忽略决策函数(公式(1))中的第1项和第2项，那么可以得到一个简化的判定函数如下。</li>
</ul>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112271553143.png" alt="image-20211227155317939"></p>
<ul>
<li>上式中的第1个二次项与类别无关，因此完全可以忽略。</li>
</ul>
<p>经过上述简化过程之后，简化后的决策函数(公式2)可以接着改写为如下的式子。</p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112271553662.png" alt="image-20211227155354525"></p>
<p>简化后的决策函数(公式3)过于冗余，我们可以用一些变量来进行替换，做如下几个定义。<br>$$<br>\left\{\begin{array}{c}<br>w_{i}=\Sigma^{-1} \mu_{i} \<br>w_{i 0}=\frac{1}{2} \mu_{i}^{T} \Sigma^{-1} \mu_{i}+\ln p\left(w_{i}\right)<br>\end{array}\right.<br>$$<br>由此，我们可以将公式3改写成如下的式子。<br>$$<br>g_i(x)=w_i^Tx+w_{i0}<br>$$</p>
<blockquote>
<p>哇哦<del>可以说是非常的爽了。数学讲究的简单就是美</del>！！！各位客官不着急。。。还没完呢，现在我们假设的是类别样本都是标准的、除了μ不同的正态分布。最终是想知道和μ之间有什么关系。所以。。。。接着来，我们要把μ给牵出来。</p>
<p>yyt:推着推着忘了，先跑路去写代码了。有空继续。</p>
</blockquote>
<p>公式改好之后再来画决策面，遇到求出复数解的问题，而且因为决策面是二次曲线，这里比较特殊是两条相交直线，所以应该会有两个解，手动判断画出合理的一条（这里其实有误，应该画出两条）。</p>
<p>另一个问题是求出复数解，我人都傻了，但方程推导确实表示的可能是一个复平面，计算机解的时候是有可能因为边缘高斯概率太小溢出，所以我直接找两个实数点延长直线画出来。</p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112291057498.jpg" alt="multipleF_Dserfaces4"></p>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112291101518.jpg" alt="multipleF_Dserfaces5"></p>
<blockquote>
<p>改变先验概率之后画出的决策面就很怪，怀疑是取错了另外一条直线的点。</p>
<p>全错了，重新来！先入为主误以为决策面是直线，但是其实应该按照方程来求解画出来。</p>
</blockquote>
<p>算出错误率看看，发现应该是决策面画错了。</p>
<table>
<thead>
<tr>
<th></th>
<th>height+weight</th>
<th>height+footsize</th>
<th>weight+footsize</th>
</tr>
</thead>
<tbody><tr>
<td>0.5</td>
<td>0.130952381</td>
<td>0.031746032</td>
<td>0.031746032</td>
</tr>
<tr>
<td>0.75</td>
<td>0.111111111</td>
<td>0.035714286</td>
<td>0.03968254</td>
</tr>
<tr>
<td>0.9</td>
<td>0.095238095</td>
<td>0.03968254</td>
<td>0.043650794</td>
</tr>
</tbody></table>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">getDecisionSurface2</span><span class="token punctuation">(</span>pBoy_choice<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> feature1_choice<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> feature2_choice<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    :param pBoy_choice: 先验概率选择默认0.5
    :param feature1_choice: 第一个特征选择默认身高
    :param feature2_choice: 第一个特征选择默认体重
    :return:
    """</span>
    <span class="token comment" spellcheck="true"># 测试两个特征</span>
    featureList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">,</span> <span class="token string">'weight'</span><span class="token punctuation">,</span> <span class="token string">'footsize'</span><span class="token punctuation">]</span>
    pBoyList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span>
    pBoy <span class="token operator">=</span> pBoyList<span class="token punctuation">[</span>pBoy_choice<span class="token punctuation">]</span>
    singleFeature1 <span class="token operator">=</span> featureList<span class="token punctuation">[</span>feature1_choice<span class="token punctuation">]</span>
    singleFeature2 <span class="token operator">=</span> featureList<span class="token punctuation">[</span>feature2_choice<span class="token punctuation">]</span>

    <span class="token comment" spellcheck="true"># p0Func1, p1Func1, p0Func2, p1Func2=trainNB2(X_train,singleFeature1,singleFeature2)</span>
    <span class="token comment" spellcheck="true"># test_id = 1</span>
    <span class="token comment" spellcheck="true"># print(X_test.iloc[test_id])</span>
    <span class="token comment" spellcheck="true"># result_gender = classifyNB2(X_test.iloc[test_id], p0Func1, p1Func1, p0Func2, p1Func2, pBoy,singleFeature1,singleFeature2)</span>
    <span class="token comment" spellcheck="true"># print(result_gender)</span>
    f1 <span class="token operator">=</span> X_train<span class="token punctuation">[</span>singleFeature1<span class="token punctuation">]</span>
    f2 <span class="token operator">=</span> X_train<span class="token punctuation">[</span>singleFeature2<span class="token punctuation">]</span>

    f1_min <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>f1<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    f2_min <span class="token operator">=</span> np<span class="token punctuation">.</span>min<span class="token punctuation">(</span>f2<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    f1_max <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>f1<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    f2_max <span class="token operator">=</span> np<span class="token punctuation">.</span>max<span class="token punctuation">(</span>f2<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 构建坐标范围这里要适合</span>
    <span class="token comment" spellcheck="true"># x_index = np.linspace(f1_min - 10, f1_max + 10, (int(f1_max - f1_min + 20) * 50))</span>
    <span class="token comment" spellcheck="true"># y_index = np.linspace(f2_min - 10, f2_max + 10, (int(f2_max - f2_min + 20) * 50))</span>
    x_index <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>f1_min <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">,</span> f1_max <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
    y_index <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span>f2_min <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">,</span> f2_max <span class="token operator">+</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>

    height_mu0<span class="token punctuation">,</span> height_std0 <span class="token operator">=</span> getNormArg<span class="token punctuation">(</span>dataDf<span class="token punctuation">[</span>singleFeature1<span class="token punctuation">]</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span>dataDf<span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    height_mu1<span class="token punctuation">,</span> height_std1 <span class="token operator">=</span> getNormArg<span class="token punctuation">(</span>dataDf<span class="token punctuation">[</span>singleFeature1<span class="token punctuation">]</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span>dataDf<span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    weight_mu0<span class="token punctuation">,</span> weight_std0 <span class="token operator">=</span> getNormArg<span class="token punctuation">(</span>dataDf<span class="token punctuation">[</span>singleFeature2<span class="token punctuation">]</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span>dataDf<span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    weight_mu1<span class="token punctuation">,</span> weight_std1 <span class="token operator">=</span> getNormArg<span class="token punctuation">(</span>dataDf<span class="token punctuation">[</span>singleFeature2<span class="token punctuation">]</span><span class="token punctuation">.</span>loc<span class="token punctuation">[</span>dataDf<span class="token punctuation">[</span><span class="token string">'gender'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    sigma<span class="token punctuation">,</span> mu<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y <span class="token operator">=</span> sy<span class="token punctuation">.</span>symbols<span class="token punctuation">(</span><span class="token string">"sigma,mu, x,y"</span><span class="token punctuation">)</span>

    p_height <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>sigma <span class="token operator">*</span> sy<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> sy<span class="token punctuation">.</span>pi<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> sy<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">-</span> mu<span class="token punctuation">)</span> <span class="token operator">/</span> sigma<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>
    p_weight <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span>sigma <span class="token operator">*</span> sy<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> sy<span class="token punctuation">.</span>pi<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> sy<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">-</span> mu<span class="token punctuation">)</span> <span class="token operator">/</span> sigma<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>
    height_f1 <span class="token operator">=</span> p_height<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>mu<span class="token punctuation">,</span> height_mu0<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sigma<span class="token punctuation">,</span> height_std0<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    height_f2 <span class="token operator">=</span> p_height<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>mu<span class="token punctuation">,</span> height_mu1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sigma<span class="token punctuation">,</span> height_std1<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    weight_f1 <span class="token operator">=</span> p_weight<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>mu<span class="token punctuation">,</span> weight_mu0<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sigma<span class="token punctuation">,</span> weight_std0<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    weight_f2 <span class="token operator">=</span> p_weight<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>mu<span class="token punctuation">,</span> weight_mu1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>sigma<span class="token punctuation">,</span> weight_std1<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    X<span class="token punctuation">,</span> Y <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>x_index<span class="token punctuation">,</span> y_index<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># x-y 平面的网格</span>
    z0 <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    z1 <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>X<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            z0<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> height_f1<span class="token punctuation">.</span>evalf<span class="token punctuation">(</span>subs<span class="token operator">=</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> x_index<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">*</span> weight_f1<span class="token punctuation">.</span>evalf<span class="token punctuation">(</span>subs<span class="token operator">=</span><span class="token punctuation">{</span>y<span class="token punctuation">:</span> y_index<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> pBoy<span class="token punctuation">)</span>
            z1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> height_f2<span class="token punctuation">.</span>evalf<span class="token punctuation">(</span>subs<span class="token operator">=</span><span class="token punctuation">{</span>x<span class="token punctuation">:</span> x_index<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">*</span> weight_f2<span class="token punctuation">.</span>evalf<span class="token punctuation">(</span>subs<span class="token operator">=</span><span class="token punctuation">{</span>y<span class="token punctuation">:</span> y_index<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">*</span> pBoy

    ax3 <span class="token operator">=</span> plt<span class="token punctuation">.</span>axes<span class="token punctuation">(</span>projection<span class="token operator">=</span><span class="token string">'3d'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Decision Surface'</span><span class="token punctuation">)</span>
    ax3<span class="token punctuation">.</span>plot_surface<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> z0<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'rainbow'</span><span class="token punctuation">)</span>
    ax3<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> z0<span class="token punctuation">,</span> zdir<span class="token operator">=</span><span class="token string">'z'</span><span class="token punctuation">,</span> offset<span class="token operator">=</span><span class="token operator">-</span><span class="token number">0.001</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'rainbow'</span><span class="token punctuation">)</span>
    ax3<span class="token punctuation">.</span>plot_surface<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> z1<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'rainbow'</span><span class="token punctuation">)</span>
    ax3<span class="token punctuation">.</span>contour<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> z1<span class="token punctuation">,</span> zdir<span class="token operator">=</span><span class="token string">'z'</span><span class="token punctuation">,</span> offset<span class="token operator">=</span><span class="token operator">-</span><span class="token number">0.001</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'rainbow'</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># zdir : 'z' | 'x' | 'y' 表示把等高线图投射到哪个面</span>
    <span class="token comment" spellcheck="true"># offset : 表示等高线图投射到指定页面的某个刻度</span>
    <span class="token comment" spellcheck="true"># plt.legend(loc='upper right')</span>
    <span class="token comment" spellcheck="true"># 设置图像z轴的显示范围，x、y轴设置方式相同</span>
    ax3<span class="token punctuation">.</span>set_zlim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.001</span><span class="token punctuation">,</span> <span class="token number">0.003</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="真-二维特征贝叶斯分类器决策面"><a href="#真-二维特征贝叶斯分类器决策面" class="headerlink" title="真~二维特征贝叶斯分类器决策面"></a>真~二维特征贝叶斯分类器决策面</h4><p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112302307021.jpg" alt="multipleF_Dserfaces12"></p>
<blockquote>
<p>为了画这个图可谓是几经波折，改一个很细节的取值问题都从晚上八点做到了十一点。深切体会到了肉眼debug的重要性。</p>
<p>没有实现自动取范围的功能，所以这个图算是半手动画出来的。</p>
<p>把所有图都跑了一遍，都是椭圆，因为没有调好范围参数，没有完全画出来。就不放了。</p>
</blockquote>
<hr>
<h4 id="模型测试"><a href="#模型测试" class="headerlink" title="模型测试"></a>模型测试</h4><h5 id="错误率-1"><a href="#错误率-1" class="headerlink" title="错误率"></a>错误率</h5><p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112291054455.png" alt="模型测试错误率"></p>
<blockquote>
<p>对比一维特征错误率下降了很多，但主要是鞋码本来就是最好的区分特征，加入新的特征反而误判</p>
</blockquote>
<h5 id="混淆矩阵-1"><a href="#混淆矩阵-1" class="headerlink" title="混淆矩阵"></a>混淆矩阵</h5><pre><code>==========The Model confusion matrix==========
total num: 252
       1          0
1      158      15
0      13      66
==============================================
precision: 0.9132947976878613
recall: 0.9239766081871345
specificity: 0.8148148148148148
F1: 0.9186046511627907</code></pre><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">testModel2_confusionMatrix</span><span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> pBoy<span class="token punctuation">,</span> feature_name1<span class="token punctuation">,</span> feature_name2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    测试模型给出混淆矩阵
    Parameters:
        X_test - 测试集
        girlConProFunc - 女生类条件概率
        boyConProFunc - 男生类条件概率
        pBoy - 男生先验概率
        singleFeature - 单一特征名
    :return: TP,FP,FN,TN
    TP = True Postive = 真阳性； FP = False Positive = 假阳性
    FN = False Negative = 假阴性； TN = True Negative = 真阴性
    """</span>
    TP <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    FP <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    FN <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    TN <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    p0Func1<span class="token punctuation">,</span> p1Func1<span class="token punctuation">,</span> p0Func2<span class="token punctuation">,</span> p1Func2 <span class="token operator">=</span> trainNB2<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> feature_name1<span class="token punctuation">,</span> feature_name2<span class="token punctuation">)</span>
    lenOfX_test <span class="token operator">=</span> len<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
    <span class="token keyword">for</span> test_id <span class="token keyword">in</span> range<span class="token punctuation">(</span>lenOfX_test<span class="token punctuation">)</span><span class="token punctuation">:</span>
        testsample <span class="token operator">=</span> X_test<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>test_id<span class="token punctuation">]</span>
        result_gender <span class="token operator">=</span> classifyNB2<span class="token punctuation">(</span>testsample<span class="token punctuation">,</span> p0Func1<span class="token punctuation">,</span> p1Func1<span class="token punctuation">,</span> p0Func2<span class="token punctuation">,</span> p1Func2<span class="token punctuation">,</span> pBoy<span class="token punctuation">,</span> feature_name1<span class="token punctuation">,</span> feature_name2<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>testsample<span class="token punctuation">[</span><span class="token string">"gender"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result_gender <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                TP <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result_gender <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                FP <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result_gender <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                FN <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result_gender <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                TN <span class="token operator">+=</span> <span class="token number">1</span>
    precision <span class="token operator">=</span> TP <span class="token operator">/</span> <span class="token punctuation">(</span>TP <span class="token operator">+</span> FP<span class="token punctuation">)</span>
    recall <span class="token operator">=</span> TP <span class="token operator">/</span> <span class="token punctuation">(</span>TP <span class="token operator">+</span> FN<span class="token punctuation">)</span>
    specificity <span class="token operator">=</span> TN <span class="token operator">/</span> <span class="token punctuation">(</span>TN <span class="token operator">+</span> FP<span class="token punctuation">)</span>
    F1 <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> TP <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> TP <span class="token operator">+</span> FP <span class="token operator">+</span> FN<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"==========The Model confusion matrix=========="</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"total num:"</span><span class="token punctuation">,</span> lenOfX_test<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"\t\t"</span><span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">,</span> TP<span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">,</span> FP<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">,</span> FN<span class="token punctuation">,</span> <span class="token string">"\t"</span><span class="token punctuation">,</span> TN<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=============================================="</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"precision:"</span><span class="token punctuation">,</span> precision<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"recall:"</span><span class="token punctuation">,</span> recall<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"specificity:"</span><span class="token punctuation">,</span> specificity<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"F1:"</span><span class="token punctuation">,</span> F1<span class="token punctuation">)</span>
    <span class="token keyword">return</span> TP<span class="token punctuation">,</span> FP<span class="token punctuation">,</span> FN<span class="token punctuation">,</span> TN<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>改一下分类器函数就行了，上面是身高体重pBoy=0.75</p>
</blockquote>
<hr>
<h4 id="其他评估指标"><a href="#其他评估指标" class="headerlink" title="其他评估指标"></a>其他评估指标</h4><h5 id="ROC曲线-1"><a href="#ROC曲线-1" class="headerlink" title="ROC曲线"></a>ROC曲线</h5><p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112291045418.jpg" alt="All_ROC_Curve1"></p>
<blockquote>
<p>画出ROC曲线后发现了问题，改变先验概率模型的AUC不变，表示模型性能都相同，很奇怪。</p>
<p>问了机器学习的老师，贝叶斯的先验概率需要根据实际数据来计算，不能随便改变。</p>
<p>我们是人为设定了不同的先验概率来设计不同的分类器，然而这样是否可行呢？</p>
</blockquote>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">ROC1</span><span class="token punctuation">(</span>pBoy_choice<span class="token punctuation">,</span> feature1_choice<span class="token punctuation">,</span>ax<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    画ROC曲线，参数同决策面选择不同模型
    :return:
    """</span>
    featureList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">,</span> <span class="token string">'weight'</span><span class="token punctuation">,</span> <span class="token string">'footsize'</span><span class="token punctuation">]</span>
    pBoyList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span>
    singleFeature <span class="token operator">=</span> featureList<span class="token punctuation">[</span>feature1_choice<span class="token punctuation">]</span>
    pBoy <span class="token operator">=</span> pBoyList<span class="token punctuation">[</span>pBoy_choice<span class="token punctuation">]</span>
    <span class="token comment" spellcheck="true"># 获取测试集真实分类</span>
    gender_list <span class="token operator">=</span> X_test<span class="token punctuation">[</span><span class="token string">"gender"</span><span class="token punctuation">]</span>
    girl_num <span class="token operator">=</span> gender_list<span class="token punctuation">[</span>gender_list <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
    boy_num <span class="token operator">=</span> gender_list<span class="token punctuation">[</span>gender_list <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># 训练单一特征贝叶斯分类器模型</span>
    girlConProFunc<span class="token punctuation">,</span> boyConProFunc <span class="token operator">=</span> trainNB1<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> singleFeature<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">getScore</span><span class="token punctuation">(</span>featureData2score<span class="token punctuation">)</span><span class="token punctuation">:</span>
        score <span class="token operator">=</span> boyConProFunc<span class="token punctuation">(</span>featureData2score<span class="token punctuation">)</span> <span class="token operator">*</span> pBoy
        <span class="token keyword">return</span> score

    <span class="token comment" spellcheck="true"># X_test_copy=X_test</span>
    lenOfX_test <span class="token operator">=</span> len<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
    score_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> test_id <span class="token keyword">in</span> range<span class="token punctuation">(</span>lenOfX_test<span class="token punctuation">)</span><span class="token punctuation">:</span>
        testsample <span class="token operator">=</span> X_test<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>test_id<span class="token punctuation">]</span>
        testsample_score <span class="token operator">=</span> getScore<span class="token punctuation">(</span>testsample<span class="token punctuation">[</span>singleFeature<span class="token punctuation">]</span><span class="token punctuation">)</span>
        score_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>testsample_score<span class="token punctuation">)</span>

    arg_sort_index <span class="token operator">=</span> np<span class="token punctuation">.</span>argsort<span class="token punctuation">(</span>score_list<span class="token punctuation">)</span>
    arg_sort_index_list <span class="token operator">=</span> arg_sort_index<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 从大到小的index</span>
    arg_sort_index_list <span class="token operator">=</span> list<span class="token punctuation">(</span>reversed<span class="token punctuation">(</span>arg_sort_index_list<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># X_test_copy=X_test_copy[arg_sort_index]</span>

    FPR_x_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    TPR_y_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

    <span class="token keyword">for</span> roc_i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> lenOfX_test<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 第roc_i+1大的score，判断为阳性的数目=roc_i+1，阴性数目为=lenOfX_test-(roc_i+1)</span>
        <span class="token comment" spellcheck="true"># roc_i=10</span>
        threshold <span class="token operator">=</span> score_list<span class="token punctuation">[</span>roc_i<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 设置阈值</span>

        max_score_index_list <span class="token operator">=</span> arg_sort_index_list<span class="token punctuation">[</span><span class="token punctuation">:</span>roc_i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 取前roc_i+1个score值的index，即判断为阳性的样本</span>
        hypo_boy_gender_list <span class="token operator">=</span> gender_list<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>max_score_index_list<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 忘记reverse了，结果全是女生。这是判成男生的样本index列表</span>
        hypo_boy_num <span class="token operator">=</span> hypo_boy_gender_list<span class="token punctuation">[</span>hypo_boy_gender_list <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 错判成男生的女生数目</span>
        <span class="token comment" spellcheck="true"># 判断FP</span>
        FP <span class="token operator">=</span> hypo_boy_num <span class="token operator">/</span> girl_num
        <span class="token comment" spellcheck="true"># 判断TP</span>
        TP <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>roc_i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> hypo_boy_num<span class="token punctuation">)</span> <span class="token operator">/</span> boy_num
        FPR_x_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>FP<span class="token punctuation">)</span>
        TPR_y_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>TP<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># FPR_x_list.append(1.0)</span>
    <span class="token comment" spellcheck="true"># TPR_y_list.append(1.0)</span>
    AUC <span class="token operator">=</span> <span class="token number">0.0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>FPR_x_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        AUC <span class="token operator">=</span> AUC <span class="token operator">+</span> <span class="token punctuation">(</span>FPR_x_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> FPR_x_list<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>TPR_y_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> TPR_y_list<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>
    <span class="token comment" spellcheck="true"># ax.title('ROC Curve of '+singleFeature)</span>
    ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">'ROC Curve of '</span><span class="token operator">+</span>singleFeature<span class="token operator">+</span><span class="token string">' and pBoy={:.2f}'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>pBoy<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>FPR_x_list<span class="token punctuation">,</span> TPR_y_list<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'ROC(AUC={:.6f})'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>AUC<span class="token punctuation">)</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Random Guess'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">'False Positive Rate'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">'True Positive Rate'</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># plt.savefig('./ROC_Curve1.jpg')</span>
    <span class="token comment" spellcheck="true"># plt.show()</span>

<span class="token keyword">def</span> <span class="token function">allROC1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    TODO： 画出所有单一特征正态分布最小错误率Bayes分类的ROC curve
    :return:
    """</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    plot_pos <span class="token operator">=</span> <span class="token number">331</span>

    <span class="token keyword">for</span> singleFeature_choice <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> pBoy_choice <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            ax1 <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplot<span class="token punctuation">(</span>plot_pos<span class="token punctuation">)</span>
            ROC1<span class="token punctuation">(</span>pBoy_choice<span class="token punctuation">,</span>singleFeature_choice<span class="token punctuation">,</span>ax1<span class="token punctuation">)</span>
            plot_pos<span class="token operator">+=</span><span class="token number">1</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>plot_pos<span class="token punctuation">)</span>


    plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'./All_ROC_Curve1.jpg'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h3 id="（3）Parzen-窗法估计"><a href="#（3）Parzen-窗法估计" class="headerlink" title="（3）Parzen 窗法估计"></a>（3）Parzen 窗法估计</h3><p>采用Parzen 窗法估计概率密度，重复步骤（1），并且进行比较。</p>
<p><a href="https://www.cnblogs.com/aminor/p/13851150.html" target="_blank" rel="noopener">作图直观理解Parzen窗估计</a></p>
<blockquote>
<p>Parzen窗估计属于<strong>非参数估计</strong>。所谓非参数估计是指，已知样本所属的类别，但未知总体概率密度函数的形式，要求我们直接推断概率密度函数本身。</p>
<p>假设一种情况，你正在屋里看《PRML》，结果天降正义掉下来一盆乒乓球，掉的哪里都是，你觉得这是天意，如果很多乒乓球都掉在了一个位置，那么那个位置下一次必掉屠龙宝刀，你想通过估计屋子里乒乓球密度，找出这个位置，那么如何估计呢？</p>
<p>假设你的屋里正好铺了地砖，每块地砖的大小都相同。你此时灵机一动，我只需要<strong>统计每块地砖上的乒乓球个数</strong>，有最多乒乓球的地砖就是屠龙宝刀的位置。</p>
<p>这似乎听起来很简单，的确，就是这么简单。</p>
</blockquote>
<ul>
<li>这里所写的窗函数表示超立方体，而不是超球体，判断条件也不是点到中心的距离小于2/h，而是点坐标的每个元素都小于2/h。</li>
</ul>
<table>
<thead>
<tr>
<th>错误率</th>
<th>0.5</th>
<th>0.75</th>
<th>0.9</th>
</tr>
</thead>
<tbody><tr>
<td>height</td>
<td>0.166666667</td>
<td>0.091269841</td>
<td>0.178571429</td>
</tr>
<tr>
<td>weight</td>
<td>0.138888889</td>
<td>0.166666667</td>
<td>0.214285714</td>
</tr>
<tr>
<td>footsize</td>
<td>0.027777778</td>
<td>0.027777778</td>
<td>0.035714286</td>
</tr>
</tbody></table>
<blockquote>
<p>使用均匀核（方窗），h=2，一维特征V=h**1，对比的图就不画了</p>
</blockquote>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112261712018.png" alt="image-20211226171222858"></p>
<h3 id="（4）最小风险的Bayes-决策"><a href="#（4）最小风险的Bayes-决策" class="headerlink" title="（4）最小风险的Bayes 决策"></a>（4）最小风险的<strong>Bayes</strong> 决策</h3><p>自行给出一个决策表，采用最小风险的<strong>Bayes</strong> 决策重复步骤（1）</p>
<blockquote>
<p>就是在决策的后验概率分别乘上风险系数，一般是根据经验设置，很简单就不做了</p>
</blockquote>
<blockquote>
<p>yyt，你不是一个会因为事情简单就放弃去尝试机会的人。</p>
</blockquote>
<p><img src="https://gitee.com/henry-avery/my_pic_bed/raw/master/img/202112261941316.png" alt="image-20211226194149262"></p>
<p>随便设了个风险系数，结果发现错误率高的离谱，0.6865079365079365。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">classifyNB4</span><span class="token punctuation">(</span>data2Classify<span class="token punctuation">,</span> p0Func<span class="token punctuation">,</span> p1Func<span class="token punctuation">,</span> pBoy<span class="token punctuation">,</span> feature_name<span class="token punctuation">,</span> riskMat<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    函数说明:最小风险贝叶斯分类器分类函数

    Parameters:
        data2Classify - 待分类的新数据
        p0Func - 女生的某特征条件概率函数
        p1Func - 男生的某特征条件概率函数
        pBoy - 属于男生的先验概率
        riskMat - 风险系数矩阵
    Returns:
        0 - 属于女生
        1 - 属于男生
    """</span>
    height <span class="token operator">=</span> data2Classify<span class="token punctuation">[</span>feature_name<span class="token punctuation">]</span>
    ln_p1 <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>p1Func<span class="token punctuation">(</span>height <span class="token operator">+</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>pBoy <span class="token operator">+</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>
    ln_p0 <span class="token operator">=</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>p0Func<span class="token punctuation">(</span>height <span class="token operator">+</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1.0</span> <span class="token operator">-</span> pBoy <span class="token operator">+</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span>
    risk0 <span class="token operator">=</span> ln_p0 <span class="token operator">*</span> riskMat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> ln_p1 <span class="token operator">*</span> riskMat<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    risk1 <span class="token operator">=</span> ln_p0 <span class="token operator">*</span> riskMat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> ln_p1 <span class="token operator">*</span> riskMat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>

    <span class="token comment" spellcheck="true"># 选风险小的</span>
    <span class="token keyword">if</span> risk1 <span class="token operator">&lt;</span> risk0<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span>

<span class="token keyword">def</span> <span class="token function">testModel4</span><span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> girlConProFunc<span class="token punctuation">,</span> boyConProFunc<span class="token punctuation">,</span> pBoy<span class="token punctuation">,</span> singleFeature<span class="token punctuation">,</span> riskMat<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    测试最小风险贝叶斯模型错误率
    Parameters:
        X_test - 测试集
        girlConProFunc - 女生类条件概率
        boyConProFunc - 男生类条件概率
        pBoy - 男生先验概率
        singleFeature - 单一特征名
    :return: error
    """</span>
    count <span class="token operator">=</span> <span class="token number">0.0</span>
    lenOfX_test <span class="token operator">=</span> len<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span>
    <span class="token keyword">for</span> test_id <span class="token keyword">in</span> range<span class="token punctuation">(</span>lenOfX_test<span class="token punctuation">)</span><span class="token punctuation">:</span>
        testsample <span class="token operator">=</span> X_test<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span>test_id<span class="token punctuation">]</span>
        result_gender <span class="token operator">=</span> classifyNB4<span class="token punctuation">(</span>testsample<span class="token punctuation">,</span> girlConProFunc<span class="token punctuation">,</span> boyConProFunc<span class="token punctuation">,</span> pBoy<span class="token punctuation">,</span> singleFeature<span class="token punctuation">,</span> riskMat<span class="token punctuation">)</span>
        <span class="token keyword">if</span> result_gender <span class="token operator">!=</span> testsample<span class="token punctuation">[</span><span class="token string">"gender"</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            count <span class="token operator">+=</span> <span class="token number">1</span>
    error <span class="token operator">=</span> count <span class="token operator">/</span> lenOfX_test
    <span class="token comment" spellcheck="true"># print("The Model error rate is ", error)</span>
    <span class="token keyword">return</span> error

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># 数据可视化准备</span>
    <span class="token comment" spellcheck="true"># year_list=[2009,2010,2011,2017,2018,2021]</span>
    dirname <span class="token operator">=</span> <span class="token string">"genderdata"</span>
    savename <span class="token operator">=</span> <span class="token string">"all_data.txt"</span>
    savepath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> savename<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># 读取文件</span>
    datapath <span class="token operator">=</span> savepath
    dataDf <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>datapath<span class="token punctuation">,</span> index_col<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
    dataDf<span class="token punctuation">.</span>index <span class="token operator">=</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>dataDf<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># 划分训练集与测试集，均匀抽样</span>
    X_all <span class="token operator">=</span> dataDf
    y_all <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>dataDf<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">"gender"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X_all<span class="token punctuation">,</span> y_all<span class="token punctuation">,</span> test_size<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> stratify<span class="token operator">=</span>y_all<span class="token punctuation">)</span>
    <span class="token comment" spellcheck="true"># data:需要进行分割的数据集</span>
    <span class="token comment" spellcheck="true"># random_state:设置随机种子，保证每次运行生成相同的随机数</span>
    <span class="token comment" spellcheck="true"># test_size:将数据分割成训练集的比例</span>

    <span class="token comment" spellcheck="true"># print("begin debug......")</span>

    <span class="token comment" spellcheck="true"># allSingleFeatureDSurface() # 画单特征决策面</span>
    <span class="token comment" spellcheck="true"># getDecisionSurface2(0,0,1) # 画多特征决策面,身高，体重，pBoy=0.5</span>
    <span class="token comment" spellcheck="true"># getDecisionSurface2_counter(2, 0, 1)  # 决策面分开画</span>

    <span class="token comment" spellcheck="true"># ROC1(0,0) # 画身高的最小错误率贝叶斯分类ROC曲线并保存</span>
    <span class="token comment" spellcheck="true"># TODO：身高的最小错误率贝叶斯分类PR曲线并保存</span>
    <span class="token comment" spellcheck="true"># PR()  #身高的最小错误率贝叶斯分类PR曲线并保存</span>
    <span class="token comment" spellcheck="true"># TODO: 贝叶斯估计</span>
    <span class="token comment" spellcheck="true"># confusionMatrix1() # 单一特征贝叶斯分类器的混淆矩阵和评估指标</span>
    <span class="token comment" spellcheck="true"># modelTests() # 测试所有单一特征贝叶斯分类器模型错误率并保存结果</span>
    <span class="token comment" spellcheck="true"># modelTests2(X_train, X_test) # 多元正态分布Bayes模型测试错误率</span>
    <span class="token comment" spellcheck="true"># modelTests3() # Parzen窗法估计，测试单一特征贝叶斯分类器模型错误率并保存结果</span>

    <span class="token comment" spellcheck="true"># 选择参数</span>
    pBoy_choice <span class="token operator">=</span> <span class="token number">0</span>
    feature_choice1 <span class="token operator">=</span> <span class="token number">0</span>
    feature_choice2 <span class="token operator">=</span> <span class="token number">1</span>
    featureList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'height'</span><span class="token punctuation">,</span> <span class="token string">'weight'</span><span class="token punctuation">,</span> <span class="token string">'footsize'</span><span class="token punctuation">]</span>
    pBoyList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">0.9</span><span class="token punctuation">]</span>
    pBoy <span class="token operator">=</span> pBoyList<span class="token punctuation">[</span>pBoy_choice<span class="token punctuation">]</span>
    feature_name1 <span class="token operator">=</span> featureList<span class="token punctuation">[</span>feature_choice1<span class="token punctuation">]</span>
    <span class="token comment" spellcheck="true"># feature_name2 = featureList[feature_choice2]</span>

    riskMat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    girlConProFunc<span class="token punctuation">,</span> boyConProFunc <span class="token operator">=</span> trainNB1<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> feature_name1<span class="token punctuation">)</span>
    error <span class="token operator">=</span> testModel4<span class="token punctuation">(</span>X_test<span class="token punctuation">,</span> girlConProFunc<span class="token punctuation">,</span> boyConProFunc<span class="token punctuation">,</span> pBoy<span class="token punctuation">,</span> feature_name1<span class="token punctuation">,</span> riskMat<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<p><strong>资料</strong></p>
<p><a href="https://blog.csdn.net/zwj1452267376/article/details/88411889" target="_blank" rel="noopener">Python基础之闭包函数</a></p>
<p><a href="https://blog.csdn.net/weixin_39824801/article/details/111630463" target="_blank" rel="noopener">python划分训练集和测试集_训练集、验证集和测试集</a></p>
<hr>
<p>grad_f1 = np.array([[float(fx.evalf(subs={x:x_tmp,y:y_tmp}))],</p>
<pre><code>[float(fy.evalf(subs={x:x_tmp,y:y_tmp}))]])     </code></pre><p>————————————————<br>版权声明：本文为CSDN博主「一小闷棍666」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/crusierLiu/article/details/105811211" target="_blank" rel="noopener">https://blog.csdn.net/crusierLiu/article/details/105811211</a></p>
<hr>
<h2 id="实验三-线性分类器设计"><a href="#实验三-线性分类器设计" class="headerlink" title="实验三 线性分类器设计"></a>实验三 线性分类器设计</h2><p><strong>以下用身高/体重/鞋尺码数据为例说明实验过程</strong></p>
<p>1、基本要求：</p>
<p>试验直接设计线性分类器的方法，与基于概率密度估计的贝叶斯分类器进行</p>
<p>比较。体会<strong>留一法</strong>估计错误率的方法和结果。</p>
<p>2、具体步骤： </p>
<p>（1）<strong>同时采用身高和体重数据</strong>作为特征，用Fisher 线性判别方法求分类器，将该分类器应用到训练和测试样本，考察训练和测试错误情况。将训练样本和求得的<strong>决策边界</strong>画到图上，同时把以往用Bayes 方法求得的分类器也画到图上，比较结果的异同。</p>
<p>（2）选择上述实验的<strong>Fisher线性判别</strong>方法，用<strong>留一法</strong>在训练集上估计错误率，与在测试集上得到的错误率进行比较。</p>
<p>3、验收内容：</p>
<p>（1）上述具体步骤2（1）（2）为必做内容；</p>
<p>（2）简述分类器原理和基本算法；</p>
<p>（3）说明程序类型；</p>
<p>（3）说明实验结果并进行分析。</p>
<hr>
<h2 id="实验四-PCA"><a href="#实验四-PCA" class="headerlink" title="实验四 PCA"></a>实验四 PCA</h2><h2 id="实验五-k近邻分类器"><a href="#实验五-k近邻分类器" class="headerlink" title="实验五 k近邻分类器"></a>实验五 k近邻分类器</h2><h2 id="实验六-SVM分类器"><a href="#实验六-SVM分类器" class="headerlink" title="实验六 SVM分类器"></a>实验六 SVM分类器</h2><h1 id="关于Python"><a href="#关于Python" class="headerlink" title="关于Python"></a>关于Python</h1><p>pycharm的快捷键CTRL+Y被redo占用了，那我就把删除整行设置成ALT+Y好了</p>
<hr>
<p><strong>np.linspace</strong>主要用来创建等差数列。<br>np.linspace参数：</p>
<pre><code>numpy.linspace(start, stop, num=50, endpoint=True, retstep=False, dtype=None, axis=0)
Return evenly spaced numbers over a specified interval.
(在start和stop之间返回均匀间隔的数据)
Returns num evenly spaced samples, calculated over the interval [start, stop].
(返回的是 [start, stop]之间的均匀分布)
The endpoint of the interval can optionally be excluded.
Changed in version 1.16.0: Non-scalar start and stop are now supported.
(可以选择是否排除间隔的终点)</code></pre><p>参数含义：</p>
<pre><code>start:返回样本数据开始点
stop:返回样本数据结束点
num:生成的样本数据量，默认为50
endpoint：True则包含stop；False则不包含stop
retstep：If True, return (samples, step), where step is the spacing between samples.(即如果为True则结果会给出数据间隔)
dtype：输出数组类型
axis：0(默认)或-1</code></pre><p>使用例子：</p>
<blockquote>
<blockquote>
<blockquote>
<p>np.linspace(2.0, 3.0, num=5)<br>array([ 2.  ,  2.25,  2.5 ,  2.75,  3.  ])<br>np.linspace(2.0, 3.0, num=5, endpoint=False)<br>array([ 2. ,  2.2,  2.4,  2.6,  2.8])<br>np.linspace(2.0, 3.0, num=5, retstep=True)<br>(array([ 2.  ,  2.25,  2.5 ,  2.75,  3.  ]), 0.25)<br>————————————————<br>版权声明：本文为CSDN博主「Asher117」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。<br>原文链接：<a href="https://blog.csdn.net/Asher117/article/details/87855493" target="_blank" rel="noopener">https://blog.csdn.net/Asher117/article/details/87855493</a></p>
</blockquote>
</blockquote>
</blockquote>
<hr>
<pre><code>word[:2]# 取前两个 
word[2:] # 除了前两个，其他全部选取</code></pre><h1 id="自学报告"><a href="#自学报告" class="headerlink" title="自学报告"></a>自学报告</h1><p>小组研讨，yolo</p>
<h1 id="课程报告"><a href="#课程报告" class="headerlink" title="课程报告"></a>课程报告</h1>
            </div>
            <hr />

            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            

    <div class="reprint" id="reprint-statement">
        <p class="reprint-tip">
            <i class="fa fa-exclamation-triangle"></i>&nbsp;&nbsp;
            <span>转载规则</span>
        </p>
        
            <div class="center-align">
                <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                    <img alt=""
                         style="border-width:0"
                         src="https://i.creativecommons.org/l/by/4.0/88x31.png"/>
                </a>
            </div>
            <br/>
            <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text"
                  property="dct:title" rel="dct:type">
                    《SHU模式识别》
                </span> 由
            <a xmlns:cc="http://creativecommons.org/ns#" href="/2021/12/31/shupr/" property="cc:attributionName"
               rel="cc:attributionURL">
                Henry-Avery
            </a> 采用
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                知识共享署名 4.0 国际许可协议
            </a>进行许可。
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>


        </div>
    </div>

    
    <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: 'bcac118c07efd37bb7c3',
        clientSecret: '59ace8a6f5bc3daffc7aa090f2f8e93c971668e8',
        repo: 'Blogtalk',
        owner: 'henry-avery',
        admin: "henry-avery",
        id: '2021/12/31/shupr/',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/02/22/shusy/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/20.jpg" class="responsive-img" alt="SHU研究方法与前沿">
                        
                        <span class="card-title">SHU研究方法与前沿</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            SHU智科大三高级研讨课
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2022-02-22
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/学习笔记/" class="post-category" target="_blank">
                                    学习笔记
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/SHU/" target="_blank">
                        <span class="chip bg-color">SHU</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/12/16/shuop/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/26.jpg" class="responsive-img" alt="SHU运筹与优化">
                        
                        <span class="card-title">SHU运筹与优化</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            主要是上机的实验代码
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2021-12-16
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/学习笔/" class="post-category" target="_blank">
                                    学习笔
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/数学/" target="_blank">
                        <span class="chip bg-color">数学</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 小天爷的博客<br />'
            + '作者: Henry-Avery<br />'
            + '链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () { bodyElement.removeChild(newdiv); }, 200);
    });
</script>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h1, h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\(', '\)']]}
    });
</script>

<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>
<script type="text/javascript" src="/libs/codeBlock/clipboard.min.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>


    <footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            &copy; 2019-2021 Henry-Avery. 版权所有

            
            &nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp;
            <span class="white-color">253.4k</span>
            

            <br>
            <span id="sitetime"></span>

            
            
            <br>
            
            <span id="busuanzi_container_site_pv" style='display:none'>
                <i class="fa fa-heart-o"></i>
                本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
            <span id="busuanzi_container_site_uv" style='display:none'>
                人次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
            </span>
            
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/henry-avery" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>







    <a href="http://wpa.qq.com/msgrd?v=3&uin=849095098&site=qq&menu=yes" class="tooltipped" target="_blank" data-tooltip="访问我的知乎" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>





    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>

<!-- 不蒜子计数初始值纠正 -->
<script>
    $(document).ready(function () {

        var int = setInterval(fixCount, 50);
        var pvcountOffset = 1;
        var uvcountOffset = 1;

        function fixCount() {
            if (document.getElementById("busuanzi_container_site_pv").style.display != "none") {
                $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + pvcountOffset);
                clearInterval(int);
            }
            if ($("#busuanzi_container_site_pv").css("display") != "none") {
                $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + uvcountOffset); // 加上初始数据 
                clearInterval(int);
            }
        }
    });
</script>

<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
        year - 作为date对象的年份，为4位年份值
        month - 0-11之间的整数，做为date对象的月份
        day - 1-31之间的整数，做为date对象的天数
        hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
        minutes - 0-59之间的整数，做为date对象的分钟数
        seconds - 0-59之间的整数，做为date对象的秒数
        microseconds - 0-999之间的整数，做为date对象的毫秒数 */
        var t1 = Date.UTC(2020, 07, 30, 00, 00, 00); //北京时间2018-2-13 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "本站已运行 " + diffYears + " 年 " + diffDays + " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
    }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消
        /*document.getElementById("sitetime").innerHTML = "本站已运行 " +  diffDays + " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
    }*/
    siteTime();
</script>

    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <script type="text/javascript"> var OriginTitile = document.title, st; document.addEventListener("visibilitychange", function () { document.hidden ? (document.title = "Σ(っ °Д °;)っ喔哟，崩溃啦！", clearTimeout(st)) : (document.title = "φ(゜▽゜*)♪咦，又好了！", st = setTimeout(function () { document.title = OriginTitile }, 3e3)) })
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>



    
    <script src="/libs/others/clicklove.js"></script>
    

    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    <!-- 雪花特效 -->
    

</body>

</html>